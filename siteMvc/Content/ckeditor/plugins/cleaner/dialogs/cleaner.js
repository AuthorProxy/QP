/*
Copyright (c) 2003-2010, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

(function(){(function(){function a(d,e){return d.getContentElement('main',e).getValue();};function b(d,e,f,g,h,i,j){if(e){d=d.replace(/\<[^>]*\>/ig,'');d=d.replace(/\&nbsp;/ig,' ');}else{if(h){d=d.replace(/\<span[^\>]*\>/ig,'');d=d.replace(/\<\/span[^\>]*\>/ig,'');}if(g){d=d.replace(/\<font[^\>]*\>/ig,'');d=d.replace(/\<\/font[^\>]*\>/ig,'');}if(i){d=d.replace(/<o:p>\s*<\/o:p>/g,'');d=d.replace(/<o:p>[\s\S]*?<\/o:p>/g,'&nbsp;');d=d.replace(/\s*mso-[^:]+:[^;"]+;?/gi,'');d=d.replace(/\s*class[\s]*=[\s]*Mso[^\s\>]+/ig,'');d=d.replace(/\s*class[\s]*=[\s]*\"Mso[^\"]*\"/ig,'');d=d.replace(/\s*class[\s]*=[\s]*\'Mso[^\']*\'/ig,'');d=d.replace(/<STYLE[^>]*>[\s\S]*?<\/STYLE[^>]*>/gi,'');d=d.replace(/<(?:META|LINK)[^>]*>\s*/gi,'');d=d.replace(/<(\w[^>]*) lang=([^ |>]*)([^>]*)/gi,'<$1$3');d=d.replace(/<\\?\?xml[^>]*>/gi,'');d=d.replace(/<w:[^>]*>[\s\S]*?<\/w:[^>]*>/gi,'');d=d.replace(/<\/?\w+:[^>]*>/gi,'');d=d.replace(/<\!--[\s\S]*?-->/g,'');d=d.replace(/<(\w[^>]*) language=([^ |>]*)([^>]*)/gi,'<$1$3');d=d.replace(/<(\w[^>]*) onmouseover="([^\"]*)"([^>]*)/gi,'<$1$3');d=d.replace(/<(\w[^>]*) onmouseout="([^\"]*)"([^>]*)/gi,'<$1$3');}if(f){d=d.replace(/\s*style[\s]*=[\s]*\"[^\"]*\"/ig,'');d=d.replace(/\s*style[\s]*=[\s]*\'[^\']*\'/ig,'');d=d.replace(/\s*style[\s]*=[\s]*[^\s\>]+/ig,'');d=d.replace(/\s*class[\s]*=[\s]*[^\s\>]+/ig,'');d=d.replace(/\s*class[\s]*=[\s]*\"[^\"]*\"/ig,'');d=d.replace(/\s*class[\s]*=[\s]*\'[^\']*\'/ig,'');}if(j){d=d.replace(/(<(?:table|td|tr).*?[\s])width[\s]?=[\s]?(\"[^\"]*\"|[^\s]+|\'[^\']*\')([^>]*>)/ig,'$1$3');d=d.replace(/(<(?:table|td|tr).*?[\s]style[\s]?=[\s]?)\"([^\"]*?)width[\s]*(?:=|:)[\s]*([^;\"]+)(?:;([^\"]*)|[\s]*)\"([^>]*>)/ig,'$1"$2$4"$5');d=d.replace(/(<(?:table|td|tr).*?[\s]style[\s]?=[\s]?)\'([^\']*?)width[\s]*(?:=|:)[\s]*([^;\']+)(?:;([^\']*)|[\s]*)\"([^>]*>)/ig,'$1"$2$4"$5');d=d.replace(/(<(?:table|td|tr).*?[\s]style[\s]?=[\s]?)(.*?)width(?:=|:)([^;\s]+)(?:;([^\s]*)|[\s]?)([^>]*>)/ig,'$1"$2$4"$5');}d=d.replace(/\s*style="\s*"/gi,'');d=d.replace(/<([^\s>]+)(\s[^>]*)?>\s+<\/\1>/g,' ');d=d.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');d=d.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');d=d.replace(/<([^\s>]+)(\s[^>]*)?>\s*<\/\1>/g,'');}return d;};var c=function(d){return{title:d.lang.cleaner.buttonLabel,minWidth:420,minHeight:360,resizable:0,buttons:[CKEDITOR.dialog.okButton,CKEDITOR.dialog.cancelButton],contents:[{id:'main',label:'',elements:[{type:'checkbox',id:'word',label:d.lang.cleaner.wordClearCheckbox,'default':'checked'},{type:'checkbox',id:'css',label:d.lang.cleaner.cssClearCheckbox,'default':'checked'},{type:'checkbox',id:'span',label:d.lang.cleaner.spanClearCheckbox,'default':'checked'},{type:'checkbox',id:'font',label:d.lang.cleaner.fontClearCheckbox,'default':'checked'},{type:'checkbox',id:'table',label:d.lang.cleaner.tableClearCheckbox},{type:'checkbox',id:'tags',label:d.lang.cleaner.tagsClearCheckbox}]}],onOk:function(){var e=CKEDITOR.dialog.getCurrent(),f=null;
if(d.mode=='source'){var g=d.textarea.getValue(),h=b(g,a(e,'tags'),a(e,'css'),a(e,'font'),a(e,'span'),a(e,'word'),a(e,'table'));d.textarea.setValue(h);}else{var g=d.getData(),h=b(g,a(e,'tags'),a(e,'css'),a(e,'font'),a(e,'span'),a(e,'word'),a(e,'table'));d.setData(h);}}};};CKEDITOR.dialog.add('cleaner',function(d){return c(d);});})();})();
