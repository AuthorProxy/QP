/*
Copyright (c) 2003-2010, CKSource - Frederico Knabben. All rights reserved.
For licensing, see LICENSE.html or http://ckeditor.com/license
*/

(function(){window.wordWindow=function(){var a=this;a._forms=[];a.wordChar=/[a-zA-Z]/;a.windowType='wordWindow';a.originalSpellings=[];a.suggestions=[];a.checkWordBgColor='pink';a.normWordBgColor='white';a.text='';a.textInputs=[];a.indexes=[];};window.wordWindow.prototype={resetForm:function(){if(this._forms)for(var a=0;a<this._forms.length;a++)this._forms[a].reset();return true;},totalMisspellings:function(){var a=0;for(var b=0;b<this.textInputs.length;b++)a+=this.totalWords(b);return a;},totalWords:function(a){return this.originalSpellings[a].length;},totalPreviousWords:function(a,b){var c=0;for(var d=0;d<=a;d++)for(var e=0;e<this.totalWords(d);e++){if(d==a&&e==b)break;else c++;}return c;},getTextVal:function(a,b){var c=this._getWordObject(a,b);if(c)return c.value;},setFocus:function(a,b){var c=this._getWordObject(a,b);if(c)if(c.type=='text'){c.focus();c.style.backgroundColor=this.checkWordBgColor;}},removeFocus:function(a,b){var c=this._getWordObject(a,b);if(c)if(c.type=='text'){c.blur();c.style.backgroundColor=this.normWordBgColor;}},setText:function(a,b,c){var j=this;var d=j._getWordObject(a,b),e,f;if(d){var g=j.indexes[a][b],h=d.value;e=j.textInputs[a].substring(0,g);f=j.textInputs[a].substring(g+h.length,j.textInputs[a].length);j.textInputs[a]=e+c+f;var i=c.length-h.length;j._adjustIndexes(a,b,i);d.size=c.length;d.value=c;j.removeFocus(a,b);}},writeBody:function(){var l=this;var a=window.document,b=false;a.open();for(var c=0;c<l.textInputs.length;c++){var d=0,e=0;a.writeln('<form name="textInput'+c+'">');var f=l.textInputs[c];l.indexes[c]=[];if(f){var g=l.originalSpellings[c];if(!g)break;a.writeln('<div class="plainText">');for(var h=0;h<g.length;h++){do{e=f.indexOf(g[h],d);d=e+g[h].length;if(e==-1)break;var i=f.charAt(e-1),j=f.charAt(d);}while(l._isWordChar(i)||l._isWordChar(j))l.indexes[c][h]=e;for(var k=l._lastPos(c,h);k<e;k++)a.write(l.printForHtml(f.charAt(k)));a.write(l._wordInputStr(g[h]));if(h==g.length-1)a.write(l.printForHtml(f.substr(d)));}a.writeln('</div>');}a.writeln('</form>');}l._forms=a.forms;a.close();},_lastPos:function(a,b){if(b>0)return this.indexes[a][b-1]+this.originalSpellings[a][b-1].length;else return 0;},printForHtml:function(a){return a;},_isWordChar:function(a){if(a.search(this.wordChar)==-1)return false;else return true;},_getWordObject:function(a,b){if(this._forms[a])if(this._forms[a].elements[b])return this._forms[a].elements[b];return null;},_wordInputStr:function(a){var b='<input readonly ';b+='class="blend" type="text" value="'+a+'" size="'+a.length+'">';
return b;},_adjustIndexes:function(a,b,c){for(var d=b+1;d<this.originalSpellings[a].length;d++)this.indexes[a][d]=this.indexes[a][d]+c;}};})();
