/*!
 * jQuery Form Plugin
 * version: 2.45 (09-AUG-2010)
 * @requires jQuery v1.3.2 or later
 *
 * Examples and documentation at: http://malsup.com/jquery/form/
 * Dual licensed under the MIT and GPL licenses:
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 */
(function(n){function t(){if(n.fn.ajaxSubmit.debug){var t="[jquery.form] "+Array.prototype.join.call(arguments,"");window.console&&window.console.log?window.console.log(t):window.opera&&window.opera.postError&&window.opera.postError(t)}}n.fn.ajaxSubmit=function(i){function y(){function b(){var f=r.attr("target"),o=r.attr("action"),t,i;e.setAttribute("target",v);e.getAttribute("method")!="POST"&&e.setAttribute("method","POST");e.getAttribute("action")!=u.url&&e.setAttribute("action",u.url);u.skipEncodingOverride||r.attr({encoding:"multipart/form-data",enctype:"multipart/form-data"});u.timeout&&setTimeout(function(){w=!0;y()},u.timeout);t=[];try{if(u.extraData)for(i in u.extraData)t.push(n('<input type="hidden" name="'+i+'" value="'+u.extraData[i]+'" />').appendTo(e)[0]);s.appendTo("body");s.data("form-plugin-onload",y);e.submit()}finally{e.setAttribute("action",o);f?e.setAttribute("target",f):r.removeAttr("target");n(t).remove()}}function y(){var i,r,e,l,a;if(!p){s.removeData("form-plugin-onload");i=!0;try{if(w)throw"timeout";if(o=c.contentWindow?c.contentWindow.document:c.contentDocument?c.contentDocument:c.document,r=u.dataType=="xml"||o.XMLDocument||n.isXMLDoc(o),t("isXml="+r),!r&&(o.body==null||o.body.innerHTML=="")){if(--d){t("requeing onLoad callback, DOM not available");setTimeout(y,250);return}t("Could not access iframe DOM after 100 tries.");throw"DOMException: not available";}t("response detected");p=!0;f.responseText=o.documentElement?o.documentElement.innerHTML:null;f.responseXML=o.XMLDocument?o.XMLDocument:o;f.getResponseHeader=function(n){var t={"content-type":u.dataType};return t[n]};e=/(json|script)/.test(u.dataType);e||u.textarea?(l=o.getElementsByTagName("textarea")[0],l?f.responseText=l.value:e&&(a=o.getElementsByTagName("pre")[0],a&&(f.responseText=a.innerHTML))):u.dataType!="xml"||f.responseXML||f.responseText==null||(f.responseXML=g(f.responseText));k=n.httpData(f,u.dataType)}catch(v){t("error caught:",v);i=!1;f.error=v;n.handleError(u,f,"error",v)}i&&(u.success.call(u.context,k,"success"),h&&n.event.trigger("ajaxSuccess",[f,u]));h&&n.event.trigger("ajaxComplete",[f,u]);h&&!--n.active&&n.event.trigger("ajaxStop");u.complete&&u.complete.call(u.context,f,i?"success":"error");setTimeout(function(){s.removeData("form-plugin-onload");s.remove();f.responseXML=null},100)}}function g(n,t){return window.ActiveXObject?(t=new ActiveXObject("Microsoft.XMLDOM"),t.async="false",t.loadXML(n)):t=(new DOMParser).parseFromString(n,"text/xml"),t&&t.documentElement&&t.documentElement.tagName!="parsererror"?t:null}var e=r[0],u,f,h,a,k,o,d;if(n(":input[name=submit],:input[id=submit]",e).length){alert('Error: Form elements must not have name or id of "submit".');return}u=n.extend(!0,{},n.ajaxSettings,i);u.context=u.context||u;var v="jqFormIO"+(new Date).getTime(),s=n('<iframe id="'+v+'" name="'+v+'" src="'+u.iframeSrc+'" onload="var f = jQuery(this).data(\'form-plugin-onload\'); if (f) f();" />'),c=s[0];if(s.css({position:"absolute",top:"-1000px",left:"-1000px"}),f={aborted:0,responseText:null,responseXML:null,status:0,statusText:"n/a",getAllResponseHeaders:function(){},getResponseHeader:function(){},setRequestHeader:function(){},abort:function(){this.aborted=1;s.attr("src",u.iframeSrc)}},h=u.global,h&&!n.active++&&n.event.trigger("ajaxStart"),h&&n.event.trigger("ajaxSend",[f,u]),u.beforeSend&&u.beforeSend.call(u.context,f,u)===!1){u.global&&n.active--;return}if(!f.aborted){var p=!1,w=0,l=e.clk;l&&(a=l.name,a&&!l.disabled&&(u.extraData=u.extraData||{},u.extraData[a]=l.value,l.type=="image"&&(u.extraData[a+".x"]=e.clk_x,u.extraData[a+".y"]=e.clk_y)));u.forceSync?b():setTimeout(b,10);d=100}}var u,h,f,o,s,l,c,r,e,a;if(!this.length)return t("ajaxSubmit: skipping submit process - no element selected"),this;if(typeof i=="function"&&(i={success:i}),u=n.trim(this.attr("action")),u&&(u=(u.match(/^([^#]+)/)||[])[1]),u=u||window.location.href||"",i=n.extend(!0,{url:u,type:this.attr("method")||"GET",iframeSrc:/^https/i.test(window.location.href||"")?"javascript:false":"about:blank"},i),h={},this.trigger("form-pre-serialize",[this,i,h]),h.veto)return t("ajaxSubmit: submit vetoed via form-pre-serialize trigger"),this;if(i.beforeSerialize&&i.beforeSerialize(this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSerialize callback"),this;if(s=this.formToArray(i.semantic),i.data){i.extraData=i.data;for(f in i.data)if(i.data[f]instanceof Array)for(l in i.data[f])s.push({name:f,value:i.data[f][l]});else o=i.data[f],o=n.isFunction(o)?o():o,s.push({name:f,value:o})}if(i.beforeSubmit&&i.beforeSubmit(s,this,i)===!1)return t("ajaxSubmit: submit aborted via beforeSubmit callback"),this;if(this.trigger("form-submit-validate",[s,this,i,h]),h.veto)return t("ajaxSubmit: submit vetoed via form-submit-validate trigger"),this;c=n.param(s);i.type.toUpperCase()=="GET"?(i.url+=(i.url.indexOf("?")>=0?"&":"?")+c,i.data=null):i.data=c;r=this;e=[];i.resetForm&&e.push(function(){r.resetForm()});i.clearForm&&e.push(function(){r.clearForm()});!i.dataType&&i.target?(a=i.success||function(){},e.push(function(t){var r=i.replaceTarget?"replaceWith":"html";n(i.target)[r](t).each(a,arguments)})):i.success&&e.push(i.success);i.success=function(n,t,u){for(var o=i.context||i,f=0,s=e.length;f<s;f++)e[f].apply(o,[n,t,u||r,r])};var p=n("input:file",this).length>0,v="multipart/form-data",w=r.attr("enctype")==v||r.attr("encoding")==v;return i.iframe!==!1&&(p||i.iframe||w)?i.closeKeepAlive?n.get(i.closeKeepAlive,y):y():n.ajax(i),this.trigger("form-submit-notify",[this,i]),this};n.fn.ajaxForm=function(i){if(this.length===0){var r={s:this.selector,c:this.context};return!n.isReady&&r.s?(t("DOM not ready, queuing ajaxForm"),n(function(){n(r.s,r.c).ajaxForm(i)}),this):(t("terminating; zero elements found by selector"+(n.isReady?"":" (DOM not ready)")),this)}return this.ajaxFormUnbind().bind("submit.form-plugin",function(t){t.isDefaultPrevented()||(t.preventDefault(),n(this).ajaxSubmit(i))}).bind("click.form-plugin",function(t){var r=t.target,u=n(r),f,i,e;if(!u.is(":submit,input:image")){if(f=u.closest(":submit"),f.length==0)return;r=f[0]}i=this;i.clk=r;r.type=="image"&&(t.offsetX!=undefined?(i.clk_x=t.offsetX,i.clk_y=t.offsetY):typeof n.fn.offset=="function"?(e=u.offset(),i.clk_x=t.pageX-e.left,i.clk_y=t.pageY-e.top):(i.clk_x=t.pageX-r.offsetLeft,i.clk_y=t.pageY-r.offsetTop));setTimeout(function(){i.clk=i.clk_x=i.clk_y=null},100)})};n.fn.ajaxFormUnbind=function(){return this.unbind("submit.form-plugin click.form-plugin")};n.fn.formToArray=function(t){var u=[],r,o,s,h,i,f,e,l,c;if(this.length===0||(r=this[0],o=t?r.getElementsByTagName("*"):r.elements,!o))return u;for(s=0,max=o.length;s<max;s++)if(e=o[s],i=e.name,i){if(t&&r.clk&&e.type=="image"){e.disabled||r.clk!=e||(u.push({name:i,value:n(e).val()}),u.push({name:i+".x",value:r.clk_x},{name:i+".y",value:r.clk_y}));continue}if(f=n.fieldValue(e,!0),f&&f.constructor==Array)for(h=0,jmax=f.length;h<jmax;h++)u.push({name:i,value:f[h]});else f!==null&&typeof f!="undefined"&&u.push({name:i,value:f})}return!t&&r.clk&&(l=n(r.clk),c=l[0],i=c.name,i&&!c.disabled&&c.type=="image"&&(u.push({name:i,value:l.val()}),u.push({name:i+".x",value:r.clk_x},{name:i+".y",value:r.clk_y}))),u};n.fn.formSerialize=function(t){return n.param(this.formToArray(t))};n.fn.fieldSerialize=function(t){var i=[];return this.each(function(){var f=this.name,r,u,e;if(f)if(r=n.fieldValue(this,t),r&&r.constructor==Array)for(u=0,e=r.length;u<e;u++)i.push({name:f,value:r[u]});else r!==null&&typeof r!="undefined"&&i.push({name:this.name,value:r})}),n.param(i)};n.fn.fieldValue=function(t){for(var f,i,r=[],u=0,e=this.length;u<e;u++)(f=this[u],i=n.fieldValue(f,t),i!==null&&typeof i!="undefined"&&(i.constructor!=Array||i.length))&&(i.constructor==Array?n.merge(r,i):r.push(i));return r};n.fieldValue=function(t,i){var a=t.name,u=t.type,h=t.tagName.toLowerCase(),e,o,r,f;if(i===undefined&&(i=!0),i&&(!a||t.disabled||u=="reset"||u=="button"||(u=="checkbox"||u=="radio")&&!t.checked||(u=="submit"||u=="image")&&t.form&&t.form.clk!=t||h=="select"&&t.selectedIndex==-1))return null;if(h=="select"){if(e=t.selectedIndex,e<0)return null;var c=[],l=t.options,s=u=="select-one",v=s?e+1:l.length;for(o=s?e:0;o<v;o++)if(r=l[o],r.selected){if(f=r.value,f||(f=r.attributes&&r.attributes.value&&!r.attributes.value.specified?r.text:r.value),s)return f;c.push(f)}return c}return n(t).val()};n.fn.clearForm=function(){return this.each(function(){n("input,select,textarea",this).clearFields()})};n.fn.clearFields=n.fn.clearInputs=function(){return this.each(function(){var n=this.type,t=this.tagName.toLowerCase();n=="text"||n=="password"||t=="textarea"?this.value="":n=="checkbox"||n=="radio"?this.checked=!1:t=="select"&&(this.selectedIndex=-1)})};n.fn.resetForm=function(){return this.each(function(){typeof this.reset!="function"&&(typeof this.reset!="object"||this.reset.nodeType)||this.reset()})};n.fn.enable=function(n){return n===undefined&&(n=!0),this.each(function(){this.disabled=!n})};n.fn.selected=function(t){return t===undefined&&(t=!0),this.each(function(){var r=this.type,i;r=="checkbox"||r=="radio"?this.checked=t:this.tagName.toLowerCase()=="option"&&(i=n(this).parent("select"),t&&i[0]&&i[0].type=="select-one"&&i.find("option").selected(!1),this.selected=t)})}})(jQuery);