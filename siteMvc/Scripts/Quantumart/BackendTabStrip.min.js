var EVENT_TYPE_TAB_STRIP_TAB_SELECT_REQUEST="OnTabSelectRequest",EVENT_TYPE_TAB_STRIP_TAB_CLOSE_REQUEST="OnTabCloseRequest",EVENT_TYPE_TAB_STRIP_TAB_SAVE_CLOSE_REQUEST="OnTabSaveAndCloseRequest",EVENT_TYPE_TAB_STRIP_FIND_IN_TREE_REQUEST="OnFindTabInTreeRequest";Quantumart.QP8.BackendTabStrip=function(n,t){Quantumart.QP8.BackendTabStrip.initializeBase(this);this._tabStripElementId=n;$q.isObject(t)&&(t.maxTabTextLength&&(this._maxTabTextLength=t.maxTabTextLength),t.maxTabMenuHeight&&(this._maxTabMenuHeight=t.maxTabMenuHeight),t.maxTabMenuItemTextLength&&(this._maxTabMenuItemTextLength=t.maxTabMenuItemTextLength));this._onDocumentBodyClickHandler=jQuery.proxy(this._onDocumentBodyClick,this);this._onTabClickingHanlder=jQuery.proxy(this._onTabClicking,this);this._onWindowResizedHandler=jQuery.proxy(this._onWindowResized,this);this._onTabStripOverflowEvokedHandler=jQuery.proxy(this._onTabStripOverflowEvoked,this);this._onTabStripOverflowPrecludedHandler=jQuery.proxy(this._onTabStripOverflowPrecluded,this);this._onCloseButtonHoveringHandler=jQuery.proxy(this._onCloseButtonHovering,this);this._onCloseButtonClickingHandler=jQuery.proxy(this._onCloseButtonClicking,this);this._onCloseButtonClickedHandler=jQuery.proxy(this._onCloseButtonClicked,this);this._onCloseButtonUnhoveringHandler=jQuery.proxy(this._onCloseButtonUnhovering,this);this._onTabMenuItemClickingHandler=jQuery.proxy(this._onTabMenuItemClicking,this);this._onTabMenuButtonHoveredHandler=jQuery.proxy(this._onTabMenuButtonHovered,this);this._onTabMenuButtonUnhoveredHandler=jQuery.proxy(this._onTabMenuButtonUnhovered,this);this._onTabMenuButtonClickingHandler=jQuery.proxy(this._onTabMenuButtonClicking,this);this._onTabMenuButtonClickedHandler=jQuery.proxy(this._onTabMenuButtonClicked,this);this._onTabMenuUpArrowHoveredHandler=jQuery.proxy(this._onTabMenuUpArrowHovered,this);this._onTabMenuUpArrowUnhoveredHandler=jQuery.proxy(this._onTabMenuUpArrowUnhovered,this);this._onTabMenuDownArrowHoveredHandler=jQuery.proxy(this._onTabMenuDownArrowHovered,this);this._onTabMenuDownArrowUnhoveredHandler=jQuery.proxy(this._onTabMenuDownArrowUnhovered,this)};Quantumart.QP8.BackendTabStrip.prototype={_tabGroups:{},_tabTypeCounters:{},_tabStripElementId:"",_tabStripElement:null,_tabStripScrollableElement:null,_tabListElement:"",_partialRemovedTabsContainerElement:null,_selectedTabId:"",_previousSelectedTabId:"",_leftSplitterPaneWidth:0,_maxTabTextLength:35,_tabMenuElement:null,_tabMenuScrollableElement:null,_tabMenuItemListElement:null,_tabMenuUpArrowButtonElement:null,_tabMenuDownArrowButtonElement:null,_tabMenuButtonContainerElement:null,_tabMenuButtonElement:null,_maxTabMenuHeight:400,_maxTabMenuItemTextLength:35,_tabContextMenuComponent:null,TAB_STRIP_BUSY_CLASS_NAME:"busy",TAB_SELECTED_CLASS_NAME:"selected",TAB_DISABLED_CLASS_NAME:"disabled",TAB_CLICKABLE_SELECTORS:"DIV.scrollable UL.tabList > LI.tab",CLOSE_BUTTON_CLICKABLE_SELECTORS:"UL.tabList > LI.tab SPAN.closeButton",TAB_MENU_BUSY_CLASS_NAME:"busy",TAB_MENU_TIMER_ID:"tabMenuTimer",TAB_MENU_UP_ARROW_CLASS_NAME:"upArrow",TAB_MENU_UP_ARROW_HOVER_CLASS_NAME:"upArrowHovered",TAB_MENU_DOWN_ARROW_CLASS_NAME:"downArrow",TAB_MENU_DOWN_ARROW_HOVER_CLASS_NAME:"downArrowHovered",TAB_MENU_CLOSE_ALL_ITEM_CODE:"CloseAll",TAB_MENU_SAVE_CLOSE_ALL_ITEM_CODE:"SaveAndCloseAll",_onDocumentBodyClickHandler:null,_onTabClickingHanlder:null,_onWindowResizedHandler:null,_onTabStripOverflowEvokedHandler:null,_onTabStripOverflowPrecludedHandler:null,_onCloseButtonHoveringHandler:null,_onCloseButtonClickingHandler:null,_onCloseButtonClickedHandler:null,_onCloseButtonUnhoveringHandler:null,_onTabMenuItemClickingHandler:null,_onTabMenuButtonHoveredHandler:null,_onTabMenuButtonUnhoveredHandler:null,_onTabMenuButtonClickingHandler:null,_onTabMenuButtonClickedHandler:null,_onTabMenuUpArrowHoveredHandler:null,_onTabMenuUpArrowUnhoveredHandler:null,_onTabMenuDownArrowHoveredHandler:null,_onTabMenuDownArrowUnhoveredHandler:null,get_tabStripElementId:function(){return this._tabStripElementId},set_tabStripElementId:function(n){this._tabStripElementId=n},get_maxTabTextLength:function(){return this._maxTabTextLength},set_maxTabTextLength:function(n){this._maxTabTextLength=n},get_maxTabMenuHeight:function(){return this._maxTabMenuHeight},set_maxTabMenuHeight:function(n){this._maxTabMenuHeight=n},get_maxTabMenuItemTextLength:function(){return this._maxTabMenuItemTextLength},set_maxTabMenuItemTextLength:function(n){this._maxTabMenuItemTextLength=n},initialize:function(){var n=jQuery("#"+this._tabStripElementId),t=jQuery("<div />",{"class":"scrollable"}),i=jQuery("<ul />",{"class":"tabList"}),r=jQuery("<div />",{id:"partialRemovedTabs",css:{display:"none"}});n.empty();t.append(i);n.append(t);n.append(r);this._tabStripElement=n.get(0);this._tabStripScrollableElement=t.get(0);this._tabListElement=i.get(0);this._partialRemovedTabsContainerElement=r.get(0);this._attachTabStripEventHandlers();this._attachCloseButtonEventHandlers();this._createTabContextMenu()},_attachTabStripEventHandlers:function(){var n=jQuery(this._tabStripElement);n.delegate(this.TAB_CLICKABLE_SELECTORS,"click",this._onTabClickingHanlder);n.on("mouseup",this.TAB_CLICKABLE_SELECTORS,jQuery.proxy(function(n){if(n.which==2){this._tabContextMenuComponent.hide(n);var t=jQuery(n.currentTarget);this._closeTabRequest(t);n.preventDefault();n.stopPropagation()}},this)).on(jQuery.fn.jeegoocontext.getContextMenuEventType(),this.TAB_CLICKABLE_SELECTORS,jQuery.proxy(function(n){this._tabContextMenuComponent.show(n,n.currentTarget);n.preventDefault()},this))},_detachTabStripEventHandlers:function(){var n=jQuery(this._tabStripElement);n.undelegate(this.TAB_CLICKABLE_SELECTORS,"click",this._onTabClickingHanlder);n.off("mouseup",this.TAB_CLICKABLE_SELECTORS).off(jQuery.fn.jeegoocontext.getContextMenuEventType(),this.TAB_CLICKABLE_SELECTORS)},fixTabStripWidth:function(n){$q.isNull(n)&&(n=0);var t=jQuery(this._tabStripElement),i=jQuery(this._tabStripScrollableElement),r=jQuery(this._tabMenuButtonContainerElement),u=t.width()-r.width();i.css("width",u+"px");i=null;t=null;r=null},markAsBusy:function(){jQuery(this._tabListElement).addClass(this.TAB_STRIP_BUSY_CLASS_NAME);jQuery(this._tabMenuItemListElement).addClass(this.TAB_MENU_BUSY_CLASS_NAME)},unmarkAsBusy:function(){jQuery(this._tabListElement).removeClass(this.TAB_STRIP_BUSY_CLASS_NAME);jQuery(this._tabMenuItemListElement).removeClass(this.TAB_MENU_BUSY_CLASS_NAME)},isTabStripOverflow:function(){for(var i=!1,r=jQuery(this._tabStripScrollableElement),f=r.width(),u=0,n=this.getAllTabs(),e=n.length,t=0;t<e;t++)u+=n.eq(t).width();return u>f&&(i=!0),n=null,r=null,i},isTabStripBusy:function(){var n=jQuery(this._tabListElement);return n.hasClass(this.TAB_STRIP_BUSY_CLASS_NAME)},generateTabGroupCode:function(n,t){var i=$a.getBackendAction(n.get_actionCode());return String.format("{0}_{1}",i.Code,i.ActionType.Code==ACTION_TYPE_CODE_ADD_NEW?t:this._getTabEntityId(n))},getTabGroup:function(n){var t=null;return this._tabGroups[n]&&(t=this._tabGroups[n]),t},createTabGroup:function(n){var t=this.getTabGroup(n);return t||(t=[],this._tabGroups[n]=t),t},updateTabGroup:function(){},closeTabGroup:function(n){var i=this.getTabGroup(n),r,t,u;if($q.isArray(i))for(r=i.length,t=0;t<r;t++)u=i[t],this.closeTab(u)},removeTabGroup:function(n){$q.removeProperty(this._tabGroups,n)},_removeEmptyTabGroup:function(n){var t=this.getTabGroup(n);$q.isArray(t)&&t.length==0&&$q.removeProperty(this._tabGroups,n)},_addTabToGroup:function(n,t){var u=this.getTab(n),r=this.getTabId(u),i=this.createTabGroup(t);$q.isArray(i)&&(Array.contains(i,r)||Array.add(i,r))},_moveTabToGroup:function(n,t,i){if(t!=i){var r=this.getTab(n),f=this.getTabId(r),u=this.getTabGroup(t);$q.isArray(u)&&(Array.remove(u,f),this._removeEmptyTabGroup(t));r=null;this._addTabToGroup(n,i)}},_removeTabFromGroup:function(n){var t=this.getTab(n),u=this.getTabId(t),i=this.getTabGroupCode(t),r=this.getTabGroup(i);$q.isArray(r)&&(Array.remove(r,u),this._removeEmptyTabGroup(i))},generateTabId:function(){var n=1,t=this.getAllTabs();if(t.length>0){var r=t.last(),u=r.attr("id"),i=u.match("[0-9]+");if(i.length==1)n=parseInt(i[0])+1;else return alert($l.TabStrip.tabIdGenerationErrorMessage),null}return String.format("tab{0}",n)},generateTabText:function(n,t){return Quantumart.QP8.BackendDocumentHost.generateTitle(n,{isTab:!0,tabNumber:t})},getAllTabs:function(){return jQuery("> LI.tab",this._tabListElement)},getAllTabsCount:function(){return this.getAllTabs().length},getTabsByGroupCode:function(n){return jQuery("> LI[groupCode='"+n+"'].tab",this._tabListElement)},getTabsCountByGroupCode:function(n){return this.getTabsByGroupCode(n).length},getTabsByParentEntityTypeCodeAndParentEntityId:function(n,t){for(var i,f=[],r=this.getAllTabs(),u=0,e=r.length;u<e;u++)i=r.eq(u),i.data("parent_entity_type_code")==n&&i.data("parent_entity_id")==t&&Array.add(f,i.get(0)),i=null;return r=null,jQuery(f)},getTabsByEventArgs:function(n){for(var t,u=[],i=this.getAllTabs(),r=0,f=i.length;r<f;r++)t=i.eq(r),t.data("entity_type_code")==n.get_entityTypeCode()&&t.data("entity_id")==n.get_entityId()&&t.data("action_code")==n.get_actionCode()&&Array.add(u,t.get(0)),t=null;return i=null,jQuery(u)},getFirstTabByGroupCode:function(n){var t=jQuery("> LI[groupCode='"+n+"'].tab:first",this._tabListElement).eq(0);return t.length==0&&(t=null),t},getTab:function(n){var t=null;return $q.isObject(n)?$q.toJQuery(n):$q.isString(n)?(t=jQuery(this._tabListElement).find("#"+n),t.length==0&&(t=null),t):void 0},isLastTab:function(n){var t=this.getTab(n);return t.next("LI").length==0},getTabId:function(n){if(!$q.isObject(n)){alert($l.TabStrip.tabNotSpecified);return}var t=$q.toJQuery(n),i="";return $q.isNullOrEmpty(t)||(i=t.attr("id")),t=null,i},getTabGroupCode:function(n){if(!$q.isObject(n)){alert($l.TabStrip.tabNotSpecified);return}var t=$q.toJQuery(n),i="";return $q.isNullOrEmpty(t)||(i=t.attr("groupCode")),t=null,i},getTabText:function(n){var t=this.getTab(n),i="";return $q.isNullOrEmpty(t)||(i=$q.toString(t.data("tab_text"),"")),i},setTabText:function(n,t){var i=this.getTab(n);if(!$q.isNullOrEmpty(i)){var r=$q.toString(t,"").trim(),u=$q.middleCutShort(r,this._maxTabTextLength),f=r.length>u.length;f?i.attr("title",r):i.removeAttr("title");i.data("tab_text",r).find("SPAN.text").text(u)}},_getTabEntityTypeCode:function(n){var t=n.get_actionTypeCode();return result=t==ACTION_TYPE_CODE_LIST?Quantumart.QP8.BackendEntityType.getParentEntityTypeCodeByCode(n.get_entityTypeCode()):n.get_entityTypeCode()},_getTabEntityId:function(n){var i=n.get_actionTypeCode(),t;return i==ACTION_TYPE_CODE_LIST?result=n.get_parentEntityId():n.get_isMultipleEntities()?(t=$o.getEntityIDsFromEntities(n.get_entities()),result=String.format("{0}_{1}",n.get_parentEntityId(),t.join("_and_"))):result=n.get_entityId(),result},getExistingTabId:function(n){var i=0,t;return n.get_actionTypeCode()!=ACTION_TYPE_CODE_ADD_NEW&&(t=this.getFirstTabByGroupCode(this.generateTabGroupCode(n,0)),$q.isObject(t)&&(i=this.getTabId(t))),i},addNewTab:function(n){var e=$a.getBackendAction(n.get_actionCode()),o=e.ActionType.Code,r=e.Code,u=o==ACTION_TYPE_CODE_ADD_NEW?this._getTabTypeCounter(r)+1:0,t=this.generateTabId(),f=this.generateTabGroupCode(n,u),h=this.generateTabText(n,u),s=jQuery(this._tabListElement),i;return s.append(this._getTabHtml(t,f)),i=this.getTab(t),this._extendTabElement(i,n,{TabGroupCode:f,TabText:h,TabTypeCode:r,TabNumber:u}),this._addTabToGroup(i,f),s=null,this.getAllTabsCount()==1&&(jQuery(window).resize(this._onWindowResizedHandler),this._addTabMenuToTabStrip()),this._previousSelectedTabId=this._selectedTabId.valueOf(),this._selectedTabId=t,o==ACTION_TYPE_CODE_ADD_NEW&&this._increaseTabTypeCounter(r),this.isTabStripOverflow()&&this._onTabStripOverflowEvokedHandler(this,null),(jQuery.isEmptyObject(n.get_context())||!n.get_context().ctrlKey)&&this.highlightTab(i),this.fixTabStripWidth(),t},updateTab:function(n,t){var i=this.getTab(n),e=$a.getBackendActionByCode(i.data("action_code")),s=e.ActionType.Code,h=e.Code,o=this.getTabGroupCode(i),p=this.getTabText(i),c=h,l=i.data("tab_number");s==ACTION_TYPE_CODE_ADD_NEW&&this._decreaseTabTypeCounter(c,l);var r=t.get_actionCode(),a=$a.getBackendAction(r),v=a.ActionType.Code;v==ACTION_TYPE_CODE_ADD_NEW&&this._increaseTabTypeCounter(r);var f=this._getTabTypeCounter(r),u=this.generateTabGroupCode(t,f),y=this.generateTabText(t,f);i.attr("groupCode",u);this._extendTabElement(i,t,{TabGroupCode:u,TabText:y,TabTypeCode:r,TabNumber:f});u!=o&&this._moveTabToGroup(i,o,u)},selfUpdateTab:function(n){this.updateTab(n,this.getEventArgsFromTab(n))},selectTab:function(n){var t=this.getTab(n);this._previousSelectedTabId=this._selectedTabId.valueOf();this._selectedTabId=this.getTabId(t);this._selectedTabId!=this._previousSelectedTabId&&(this.highlightTab(t),this.fixTabStripWidth())},selectTabRequest:function(n){var t=this.getEventArgsFromTab(n);$q.isObject(t)&&this.notify(EVENT_TYPE_TAB_STRIP_TAB_SELECT_REQUEST,t);t=null},highlightTab:function(n){var t=this.getTab(n),i=this.getAllTabs();i.removeClass(this.TAB_SELECTED_CLASS_NAME);t.addClass(this.TAB_SELECTED_CLASS_NAME);this.scrollToTab(t)},scrollToTab:function(n,t){var o=this,i=this.getTab(n);if(i){var r=jQuery(this._tabStripScrollableElement),f=r.width(),e=i.width(),u=0;u=-1*(f-e);this.isLastTab(i)||(u+=30);r.scrollTo(i,{duration:t||400,axis:"x",offset:u});r=null}i=null},closeTab:function(n){var t=this.getTab(n);if(!$q.isNullOrEmpty(t)){var u=this.getTabId(t),i=t.data("tab_type_code"),r=t.data("tab_number");this._partialRemoveTab(t);this.isTabStripOverflow()||this._onTabStripOverflowPrecludedHandler(this,null);this._decreaseTabTypeCounter(i,r);this.getAllTabsCount()==0&&(this._hideTabMenu(),this._removeTabMenuFromTabStrip(),jQuery(window).unbind("resize",this._onWindowResizedHandler));this._removeTab(t)}t=null},_partialRemoveTab:function(n){var t=this.getTab(n),i=jQuery(this._partialRemovedTabsContainerElement);t.appendTo(i)},_removeTab:function(n){var t=this.getTab(n);t.removeData().empty().remove();this._removeTabFromGroup(t)},_getTabHtml:function(n,t){var i=new $.telerik.stringBuilder;return i.cat('<li id="'+$q.htmlEncode(n)+'" groupCode="'+$q.htmlEncode(t)+'" class="tab">\n').cat('  <a class="tabLink" href="javascript:void(0);">').cat('<span class="wrapper">').cat('<span class="text"><\/span>').cat('<span class="closeButton"><img src="'+COMMON_IMAGE_FOLDER_URL_ROOT+'0.gif" /><\/span>').cat("<\/span>").cat("<\/a>").cat("<\/li>\n"),i.string()},_extendTabElement:function(n,t,i){var r=this.getTab(n);r.data("entity_type_code",t.get_entityTypeCode());r.data("entity_id",t.get_entityId());r.data("entity_name",t.get_entityName());r.data("parent_entity_type_code",Quantumart.QP8.BackendEntityType.getParentEntityTypeCodeByCode(t.get_entityTypeCode()));r.data("parent_entity_id",t.get_parentEntityId());r.data("action_type_code",t.get_actionTypeCode());r.data("action_code",t.get_actionCode());r.data("is_multiple_entities",t.get_isMultipleEntities());r.data("entities",t.get_entities());r.data("tab_type_code",i.TabTypeCode);r.data("tab_number",i.TabNumber);this.setTabText(r,i.TabText)},_getCloseButton:function(n){var t=this.getTab(n);return t.find("> A.tabLink > SPAN.wrapper > SPAN.closeButton")},_attachCloseButtonEventHandlers:function(){var n=jQuery(this._tabStripElement);n.delegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseover",this._onCloseButtonHoveringHandler).delegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mousedown",this._onCloseButtonClickingHandler).delegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseup",this._onCloseButtonClickedHandler).delegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseout",this._onCloseButtonUnhoveringHandler)},_detachCloseButtonEventHandlers:function(){var n=jQuery(this._tabStripElement);n.undelegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseover",this._onCloseButtonHoveringHandler).undelegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mousedown",this._onCloseButtonClickingHandler).undelegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseup",this._onCloseButtonClickedHandler).undelegate(this.CLOSE_BUTTON_CLICKABLE_SELECTORS,"mouseout",this._onCloseButtonUnhoveringHandler)},_applyHoveredStyleToCloseButton:function(n){var t=jQuery("IMG",n);t.removeClass("clicked").addClass("hover")},_applyClickedStyleToCloseButton:function(n){var t=jQuery("IMG",n);t.removeClass("hover").addClass("clicked")},_cancelAllStylesForCloseButton:function(n){var t=jQuery("IMG",n);t.removeClass("hover").removeClass("clicked")},isTabSelected:function(n){var t=this.getTab(n),i=this.getTabId(t);return i==this._selectedTabId},_getTabTypeCounter:function(n){var t=0;return this._tabTypeCounters[n]&&(t=this._tabTypeCounters[n]),t},_increaseTabTypeCounter:function(n){this._tabTypeCounters[n]?this._tabTypeCounters[n]+=1:this._tabTypeCounters[n]=1},_decreaseTabTypeCounter:function(n,t){var i;if(this._tabTypeCounters[n]){var r=this.getAllTabs(),f=r.length,u=0;for(i=0;i<f;i++)r.eq(i).data("tab_type_code")==n&&u++;u!=0?this._getTabTypeCounter(n)==t&&(this._tabTypeCounters[n]-=1):this._tabTypeCounters[n]=0;r=null}},_isTabMenuOverflow:function(){var n=jQuery(this._tabMenuItemListElement).outerHeight(),t=jQuery(this._tabMenuScrollableElement).outerHeight();return n-t>1},_isTabMenuTopOverflow:function(){var n=jQuery(this._tabMenuScrollableElement).scrollTop();return n>0},_isTabMenuBottomOverflow:function(){var n=jQuery(this._tabMenuScrollableElement),t=jQuery(this._tabMenuItemListElement).height(),i=n.height(),r=n.scrollTop();return n=null,r<t-i},_calculateTabMenuScrollingDuration:function(n){var u=0,i=jQuery(this._tabMenuScrollableElement),e=jQuery(this._tabMenuItemListElement).height(),f=i.height(),r=i.scrollTop(),t;return i=null,t=0,n?r>0&&(t=r+f/2):t=e-r-f/2,t>0&&(u=parseFloat(t)*1500/220),u},_addTabMenuToTabStrip:function(){var e=jQuery(this._tabStripElement),t,o,n,u,i,f,r;this._tabMenuButtonContainerElement==null&&($menuButtonContainer=jQuery("<div />",{"class":"tabMenuButton"}),t=jQuery("<span />"),o=jQuery("<img />",{src:COMMON_IMAGE_FOLDER_URL_ROOT+"0.gif",css:{border:"none"}}),t.append(o),$menuButtonContainer.append(t),this._tabMenuButtonContainerElement=$menuButtonContainer.get(0),this._tabMenuButtonElement=t.get(0),this._attachTabMenuButtonEventHandlers(),e.append($menuButtonContainer),o=null,t=null,$menuButtonContainer=null);this._tabMenuElement==null&&(n=jQuery("<div />",{"class":"tabMenu"}),u=jQuery("<div />",{"class":this.TAB_MENU_UP_ARROW_CLASS_NAME,css:{display:"none"}}),n.append(u),i=jQuery("<div />",{"class":"scrollable"}),n.append(i),f=jQuery("<ul />"),i.append(f),r=jQuery("<div />",{"class":this.TAB_MENU_DOWN_ARROW_CLASS_NAME,css:{display:"none"}}),r.hide(0),n.append(r),this._tabMenuElement=n.get(0),this._tabMenuUpArrowButtonElement=u.get(0),this._tabMenuScrollableElement=i.get(0),this._tabMenuDownArrowButtonElement=r.get(0),this._tabMenuItemListElement=f.get(0),this._attachTabMenuEventHandlers(),e.append(n),f=null,r=null,i=null,u=null,n=null);e=null},_removeTabMenuFromTabStrip:function(){var n,t;this._detachTabMenuButtonEventHandlers();n=jQuery(this._tabMenuButtonContainerElement);n.empty().remove();n=null;this._detachTabMenuEventHandlers();t=jQuery(this._tabMenuElement);t.stopTime(this.TAB_MENU_TIMER_ID).empty().remove();t=null;this._tabMenuButtonElement=null;this._tabMenuButtonContainerElement=null;this._tabMenuItemListElement=null;this._tabMenuUpArrowButtonElement=null;this._tabMenuScrollableElement=null;this._tabMenuDownArrowButtonElement=null;this._tabMenuElement=null},_attachTabMenuEventHandlers:function(){var n,t,i;jQuery(document.body).bind("click",this._onDocumentBodyClickHandler).bind("dblclick",this._onDocumentBodyClickHandler).bind("contextmenu",this._onDocumentBodyClickHandler);n=jQuery(this._tabMenuElement);n.delegate("LI.item","click",this._onTabMenuItemClickingHandler);n=null;t=jQuery(this._tabMenuUpArrowButtonElement);t.bind("mouseover",this._onTabMenuUpArrowHoveredHandler).bind("mouseout",this._onTabMenuUpArrowUnhoveredHandler);t=null;i=jQuery(this._tabMenuDownArrowButtonElement);i.bind("mouseover",this._onTabMenuDownArrowHoveredHandler).bind("mouseout",this._onTabMenuDownArrowUnhoveredHandler);i=null},_detachTabMenuEventHandlers:function(){var n,t,i;jQuery(document.body).unbind("click",this._onDocumentBodyClickHandler).unbind("dblclick",this._onDocumentBodyClickHandler).unbind("contextmenu",this._onDocumentBodyClickHandler);n=jQuery(this._tabMenuElement);n.undelegate("LI.item","click",this._onTabMenuItemClickingHandler);n=null;t=jQuery(this._tabMenuUpArrowButtonElement);t.unbind("mouseover",this._onTabMenuUpArrowHoveredHandler).unbind("mouseout",this._onTabMenuUpArrowUnhoveredHandler);t=null;i=jQuery(this._tabMenuDownArrowButtonElement);i.unbind("mouseover",this._onTabMenuDownArrowHoveredHandler).unbind("mouseout",this._onTabMenuDownArrowUnhoveredHandler);i=null},_getMenuItems:function(){return jQuery("LI.item",this._tabMenuItemListElement)},_changeTabStripOverflowIndicator:function(n){var t=jQuery(this._tabMenuButtonContainerElement);n?t.removeClass("tabMenuButton").addClass("tabOverflowMenuButton"):t.removeClass("tabOverflowMenuButton").addClass("tabMenuButton");t=null},_loadItemsToTabMenu:function(){var i,t,f;this._removeItemsFromTabMenu();var u=jQuery(this._tabMenuItemListElement),r=this.getAllTabs(),e=r.length,n=new $.telerik.stringBuilder;for(i=0;i<e;i++)t=r.eq(i),t&&(f={TabId:this.getTabId(t),TabText:this.getTabText(t),Selected:this.isTabSelected(t),Icon:""},this._getTabMenuItemHtml(n,f));n.cat('<li class="separator"><\/li>');this._getTabMenuItemHtml(n,{TabId:this.TAB_MENU_SAVE_CLOSE_ALL_ITEM_CODE,TabText:$l.TabStrip.saveAndCloseAllTabs,Icon:""});this._getTabMenuItemHtml(n,{TabId:this.TAB_MENU_CLOSE_ALL_ITEM_CODE,TabText:$l.TabStrip.closeAllTabs,Icon:""});u.html(n.string());n=null;r=null;u=null},_getTabMenuItemHtml:function(n,t){var i=$q.toString(t.TabText,"").trim(),u=$q.middleCutShort(i,this._maxTabMenuItemTextLength),f=i.length>u.length,r=$q.htmlEncode(u);t.Selected&&(r="<b>"+r+"<\/b>");n.cat('<li code="'+$q.htmlEncode(t.TabId)+'" class="item"').catIf(' title="'+$q.htmlEncode(i)+'"',f).cat(">\n").cat('  <div class="outerWrapper">\n').cat('      <div class="innerWrapper">\n').cat('          <span class="icon"').catIf(' style="background-image: url('+THEME_IMAGE_FOLDER_URL_SMALL_ICONS+t.Icon+')"',!$q.isNullOrWhiteSpace(t.Icon)).cat(">").cat('<img src="'+COMMON_IMAGE_FOLDER_URL_ROOT+'/0.gif" width="16px" height="16px" />').cat("<\/span>\n").cat('          <span class="text">'+r+"<\/span>\n").cat("      <\/div>\n").cat("  <\/div>\n").cat("<\/li>\n")},_removeItemsFromTabMenu:function(){var n=jQuery(this._tabMenuItemListElement);n.empty();n=null},_toggleTabMenu:function(){var n=jQuery(this._tabMenuElement);n.is(":hidden")?this._showTabMenu():this._hideTabMenu();n=null},_showTabMenu:function(){var r=this,n,i;this._tabContextMenuComponent.hide();n=jQuery(this._tabMenuElement);n.css("height","auto");this._loadItemsToTabMenu();var t=jQuery(this._tabMenuButtonElement),o=n.outerWidth(),u=n.outerHeight(),f=t.offset().top+t.height()+t.borderTopWidth()+t.borderBottomWidth(),e=jQuery(window).width()-t.offset().left-t.outerWidth();t=null;i=jQuery(this._tabMenuScrollableElement);u>this._maxTabMenuHeight?i.css({height:this._maxTabMenuHeight+"px",overflow:"hidden"}):i.css({height:"auto",overflow:"visible"});i=null;n.css("top",f+"px");n.css("right",e+"px");n.fadeIn(200,function(){r._refreshTabMenuArrowButtons();n.everyTime(30,this.TAB_MENU_TIMER_ID,function(){r._refreshTabMenuArrowButtons()});n=null})},_hideTabMenu:function(){var i=this,t=jQuery(this._tabMenuElement),r=jQuery(this._tabMenuUpArrowButtonElement),u=jQuery(this._tabMenuDownArrowButtonElement),n;t.stopTime(this.TAB_MENU_TIMER_ID);r.fadeOut(50);u.fadeOut(50);t.fadeOut(200,function(){i._isTabMenuOverflow()&&i._scrollTabMenuToFirstItem(0);r=null;u=null;t=null});n=jQuery(this._tabMenuButtonElement);this._cancelAllStylesForTabMenuButton(n);n.bind("mouseover",this._onTabMenuButtonHoveredHandler).bind("mouseout",this._onTabMenuButtonUnhoveredHandler);n=null;this._removeItemsFromTabMenu()},_refreshTabMenuArrowButtons:function(){var n=jQuery(this._tabMenuUpArrowButtonElement),t=jQuery(this._tabMenuDownArrowButtonElement),i=this._isTabMenuOverflow();i&&this._isTabMenuTopOverflow()?n.fadeIn(30):n.fadeOut(30);i&&this._isTabMenuBottomOverflow()?t.fadeIn(30):t.fadeOut(30);n=null;t=null},_scrollTabMenuToFirstItem:function(n){n==null&&(n=this._calculateTabMenuScrollingDuration(!0));var i=jQuery(this._tabMenuScrollableElement),r=this._getMenuItems().first(),t={axis:"y",easing:"swing"};t.duration=n;i.scrollTo(r,t);t=null;r=null;i=null},_scrollTabMenuToLastItem:function(n){n==null&&(n=this._calculateTabMenuScrollingDuration(!1));var i=jQuery(this._tabMenuScrollableElement),r=this._getMenuItems().last(),t={axis:"y",easing:"swing"};t.duration=n;i.scrollTo(r,t);t=null;r=null;i=null},_stopTabMenuScrolling:function(){var n=jQuery(this._tabMenuScrollableElement);n.stop();n=null},_attachTabMenuButtonEventHandlers:function(){var n=jQuery(this._tabMenuButtonElement);n.bind("mouseover",this._onTabMenuButtonHoveredHandler).bind("mousedown",this._onTabMenuButtonClickingHandler).bind("click",this._onTabMenuButtonClickedHandler).bind("mouseout",this._onTabMenuButtonUnhoveredHandler);n=null},_detachTabMenuButtonEventHandlers:function(){var n=jQuery(this._tabMenuButtonElement);n.unbind("mouseover",this._onTabMenuButtonHoveredHandler).unbind("mousedown",this._onTabMenuButtonClickingHandler).unbind("click",this._onTabMenuButtonClickedHandler).unbind("mouseout",this._onTabMenuButtonUnhoveredHandler);n=null},_applyHoveredStyleToTabMenuButton:function(n){var t=jQuery(n);t.addClass("hover");t=null},_applyClickedStyleToTabMenuButton:function(n){var t=jQuery(n);t.removeClass("hover").addClass("clicked");t=null},_cancelAllStylesForTabMenuButton:function(n){var t=jQuery(n);t.removeClass("hover").removeClass("clicked");t=null},isTabMenuBusy:function(){var n=jQuery(this._tabMenuItemListElement),t=n.hasClass(this.TAB_MENU_BUSY_CLASS_NAME);return n=null,t},getEventArgsFromTab:function(n){var i=this.getTab(n),r=i.data("action_code"),u=$a.getBackendActionByCode(r),t=new Quantumart.QP8.BackendTabEventArgs;return t.set_entityTypeCode(i.data("entity_type_code")),t.set_entityId(i.data("entity_id")),t.set_entityName(i.data("entity_name")),t.set_parentEntityId(i.data("parent_entity_id")),t.set_actionCode(r),t.set_actionTypeCode(u.ActionType.Code),t.set_entities(i.data("entities")),t.set_isMultipleEntities($q.toBoolean(i.data("is_multiple_entities"),!1)),t.set_tabId(this.getTabId(i)),t},updateParentInfo:function(n,t){for(var u,i=this.getTabsByParentEntityTypeCodeAndParentEntityId(n,t),r=0,f=i.length;r<f;r++)u=i.eq(r),this.selfUpdateTab(u),u=null;i=null},tabEntityExists:function(n){var r=!0,o=n.data("action_type_code"),t,u,f,i,e;if(o!=ACTION_TYPE_CODE_ADD_NEW&&o!=ACTION_TYPE_CODE_MULTIPLE_SELECT){if(t=this.getEventArgsFromTab(n),u=this._getTabEntityTypeCode(t),$q.toBoolean(n.data("is_multiple_entities"),!1)){for(f=n.data("entities"),i=0;i<f.length;i++)if(e=f[i],e&&!$o.checkEntityExistence(u,e.Id)){r=!1;break}}else r=$o.checkEntityExistence(u,this._getTabEntityId(t));t=null}return r},getAnotherTabToSelect:function(n){var t=null,i=this.isTabSelected(n);return i?(t=n.next(),$q.isNullOrEmpty(t)&&(t=n.prev())):t=this.getTab(this._selectedTabId),t},_onDocumentBodyClick:function(){this._hideTabMenu()},_onTabClicking:function(n){var t=$(n.currentTarget);t.hasClass(this.TAB_DISABLED_CLASS_NAME)||this.isTabSelected(t)||this.isTabStripBusy()?n.preventDefault():this.selectTabRequest(t)},_onWindowResized:function(){this.fixTabStripWidth()},_onTabStripOverflowEvoked:function(){this._changeTabStripOverflowIndicator(!0)},_onTabStripOverflowPrecluded:function(){this._changeTabStripOverflowIndicator(!1)},_onCloseButtonHovering:function(n){this._applyHoveredStyleToCloseButton(n.currentTarget)},_onCloseButtonClicking:function(n){this.isTabStripBusy()?n.preventDefault():this._applyClickedStyleToCloseButton(n.currentTarget)},_onCloseButtonClicked:function(n){if(this.isTabStripBusy())n.preventDefault();else{this._tabContextMenuComponent.hide(n);var t=jQuery(n.currentTarget).parent().parent().parent();this._closeTabRequest(t);this._applyHoveredStyleToCloseButton(n.currentTarget);n.stopPropagation()}},_closeTabRequest:function(n){if(!this.isTabStripBusy()){var t=this.getEventArgsFromTab(n);$q.isObject(t)&&this.notify(EVENT_TYPE_TAB_STRIP_TAB_CLOSE_REQUEST,t);t=null}},_closeAllTabRequest:function(){this.isTabStripBusy()||jQuery(this._tabStripElement).find(this.TAB_CLICKABLE_SELECTORS).each(jQuery.proxy(function(n,t){this._closeTabRequest(t)},this))},_saveAndCloseAllTabRequest:function(){this.isTabStripBusy()||jQuery(this._tabStripElement).find(this.TAB_CLICKABLE_SELECTORS).each(jQuery.proxy(function(n,t){var i=this.getEventArgsFromTab(t);$q.isObject(i)&&this.notify(EVENT_TYPE_TAB_STRIP_TAB_SAVE_CLOSE_REQUEST,i);i=null},this))},_closeButThisTabRequest:function(n){this.isTabStripBusy()||(jQuery(this._tabStripElement).find(this.TAB_CLICKABLE_SELECTORS).not(n).each(jQuery.proxy(function(n,t){this._closeTabRequest(t)},this)),this.scrollToTab(n,1),this.fixTabStripWidth())},_findInTreeRequest:function(n){var t=this.getEventArgsFromTab(n);$q.isObject(t)&&(t.isExpandRequested=!0,this.notify(EVENT_TYPE_TAB_STRIP_FIND_IN_TREE_REQUEST,t));t=null},_onCloseButtonUnhovering:function(n){this._cancelAllStylesForCloseButton(n.currentTarget)},_onTabMenuItemClicking:function(n){if(this.isTabMenuBusy())n.preventDefault();else{var i=jQuery(n.currentTarget),t=i.attr("code");t===this.TAB_MENU_CLOSE_ALL_ITEM_CODE?this._closeAllTabRequest():t===this.TAB_MENU_SAVE_CLOSE_ALL_ITEM_CODE?this._saveAndCloseAllTabRequest():this.selectTabRequest(t);this._hideTabMenu()}},_onTabMenuButtonHovered:function(n){this._applyHoveredStyleToTabMenuButton(n.currentTarget)},_onTabMenuButtonUnhovered:function(n){this._cancelAllStylesForTabMenuButton(n.currentTarget)},_onTabMenuButtonClicking:function(n){this.isTabMenuBusy()?n.preventDefault():(this._applyClickedStyleToTabMenuButton(n.currentTarget),n.stopPropagation())},_onTabMenuButtonClicked:function(n){if(this.isTabMenuBusy())n.preventDefault();else{var t=jQuery(n.currentTarget);t.unbind("mouseover",this._onTabMenuButtonHoveredHandler).unbind("mouseout",this._onTabMenuButtonUnhoveredHandler);t=null;this._toggleTabMenu();n.stopPropagation()}},_onTabMenuUpArrowHovered:function(n){var t=jQuery(n.currentTarget);t.removeClass(this.TAB_MENU_UP_ARROW_CLASS_NAME).addClass(this.TAB_MENU_UP_ARROW_HOVER_CLASS_NAME);this._scrollTabMenuToFirstItem();t=null},_onTabMenuUpArrowUnhovered:function(n){var t=jQuery(n.currentTarget);t.removeClass(this.TAB_MENU_UP_ARROW_HOVER_CLASS_NAME).addClass(this.TAB_MENU_UP_ARROW_CLASS_NAME);this._stopTabMenuScrolling();t=null},_onTabMenuDownArrowHovered:function(n){var t=jQuery(n.currentTarget);t.removeClass(this.TAB_MENU_DOWN_ARROW_CLASS_NAME).addClass(this.TAB_MENU_DOWN_ARROW_HOVER_CLASS_NAME);this._scrollTabMenuToLastItem();t=null},_onTabMenuDownArrowUnhovered:function(n){var t=jQuery(n.currentTarget);t.removeClass(this.TAB_MENU_DOWN_ARROW_HOVER_CLASS_NAME).addClass(this.TAB_MENU_DOWN_ARROW_CLASS_NAME);this._stopTabMenuScrolling();t=null},_createTabContextMenu:function(){var i="close",r="close_but_this",u="close_all",f="find_in_tree",t=this._tabStripElementId+"_tabContextMenu",e=jQuery("<ul />",{id:t,"class":"contextMenu"}),n=new $.telerik.stringBuilder;this._getTabMenuItemHtml(n,{TabId:i,TabText:$l.TabStrip.closeTab,Icon:""});this._getTabMenuItemHtml(n,{TabId:r,TabText:$l.TabStrip.closeAllButThis,Icon:""});this._getTabMenuItemHtml(n,{TabId:u,TabText:$l.TabStrip.closeAllTabs,Icon:""});n.cat('<li class="separator"><\/li>');this._getTabMenuItemHtml(n,{TabId:f,TabText:$l.TabStrip.findInTree,Icon:""});e.html(n.string());jQuery("BODY:first").append(e);this._tabContextMenuComponent=jQuery(this._tabStripElement).jeegoocontext({menuElementId:t,menuClass:"contextMenu",allowManualShowing:!0,onSelect:jQuery.proxy(function(n,t){var e=jQuery(n.currentTarget).attr("code"),o=jQuery(t);e===i?this._closeTabRequest(o):e===u?this._closeAllTabRequest():e===r?this._closeButThisTabRequest(o):e===f&&this._findInTreeRequest(o)},this)}).data("jeegoocontext_"+t)},dispose:function(){var n,t,i;Quantumart.QP8.BackendTabStrip.callBaseMethod(this,"dispose");this._tabGroups=null;this._tabTypeCounters=null;this._detachCloseButtonEventHandlers();this._detachTabStripEventHandlers();this._partialRemovedTabsContainerElement!=null&&(n=jQuery(this._partialRemovedTabsContainerElement),n.empty().remove(),n=null,this._partialRemovedTabsContainerElement=null);this._tabListElement!=null&&(t=jQuery(this._tabListElement),t.empty().remove(),t=null,this._tabListElement=null);this._tabStripScrollableElement!=null&&(i=jQuery(this._tabStripScrollableElement),i.empty().remove(),i=null,this._tabStripScrollableElement=null);this._tabContextMenuComponent&&(this._tabContextMenuComponent.dispose(),this._tabContextMenuComponent=null);this._tabStripElement=null;this._onDocumentBodyClickHandler=null;this._onTabClickingHanlder=null;this._onWindowResizedHandler=null;this._onTabStripOverflowEvokedHandler=null;this._onTabStripOverflowPrecludedHandler=null;this._onCloseButtonHoveringHandler=null;this._onCloseButtonClickingHandler=null;this._onCloseButtonClickedHandler=null;this._onCloseButtonUnhoveringHandler=null;this._onTabMenuItemClickingHandler=null;this._onTabMenuButtonHoveredHandler=null;this._onTabMenuButtonUnhoveredHandler=null;this._onTabMenuButtonClickingHandler=null;this._onTabMenuButtonClickedHandler=null;this._onTabMenuUpArrowHoveredHandler=null;this._onTabMenuUpArrowUnhoveredHandler=null;this._onTabMenuDownArrowHoveredHandler=null;this._onTabMenuDownArrowUnhoveredHandler=null;$q.collectGarbageInIE()}};Quantumart.QP8.BackendTabStrip._instance=null;Quantumart.QP8.BackendTabStrip.getInstance=function(n,t){if(Quantumart.QP8.BackendTabStrip._instance==null){var i=new Quantumart.QP8.BackendTabStrip(n,t);Quantumart.QP8.BackendTabStrip._instance=i}return Quantumart.QP8.BackendTabStrip._instance};Quantumart.QP8.BackendTabStrip.registerClass("Quantumart.QP8.BackendTabStrip",Quantumart.QP8.Observable);Quantumart.QP8.BackendTabEventArgs=function(){Quantumart.QP8.BackendTabEventArgs.initializeBase(this)};Quantumart.QP8.BackendTabEventArgs.prototype={_tabId:"",get_tabId:function(){return this._tabId},set_tabId:function(n){this._tabId=n}};Quantumart.QP8.BackendTabEventArgs.registerClass("Quantumart.QP8.BackendTabEventArgs",Quantumart.QP8.BackendEventArgs);