Quantumart.QP8.BackendSettingsPopupWindow=function(n,t,i){this._eventsArgs=n;this._actionCode=n.get_actionCode();this._settingsActionUrl=n.settingsActionUrl;t&&(this._isSettingsSet=t.isSettingsSet,this._contentId=t.ContentId,this._blockedFieldId=t.BlockedFieldId,t=jQuery.extend(t,{additionalUrlParameters:{blockedFieldId:t.BlockedFieldId}}));this._callback=i;this._initializeSettingsWindow();Quantumart.QP8.BackendSettingsPopupWindow.initializeBase(this,[n,t]);this._popupWindowToolbarComponent=this._createToolbar();this.openWindow();this._settingsWindow.InitActions(this,t)};Quantumart.QP8.BackendSettingsPopupWindow.prototype={_contentId:0,_eventsArgs:null,_isSettingsSet:!1,_callback:null,_settingsWindow:null,_settingsActionUrl:null,_blockedFieldId:0,NEXT_BUTTON:"Next",_initializeSettingsWindow:function(){switch(this._actionCode){case"import_articles":this._settingsWindow=new Quantumart.QP8.MultistepActionImportSettings(this);break;case"export_articles":case"multiple_export_article":case"export_virtual_articles":case"multiple_export_virtual_article":this._settingsWindow=new Quantumart.QP8.MultistepActionExportSettings(this);break;case"copy_site":this._settingsWindow=new Quantumart.QP8.MultistepActionCopySiteSettings}},_createToolbar:function(){var n=new Quantumart.QP8.BackendToolbar;return n.set_toolbarElementId("popupWindowToolbar_"+this._popupWindowId),n.initialize(),n.attachObserver(EVENT_TYPE_TOOLBAR_BUTTON_CLICKED,jQuery.proxy(this._onPopupWindowToolbarButtonClicked,this)),n.addToolbarItemsToToolbar(this._getToolbarItems()),n},openWindow:function(){var n=this;this._popupWindowComponent&&this._popupWindowComponent.openWindow({hasSettings:!0,isSettingsSet:this._isSettingsSet,asyncReq:!1})},_getToolbarItems:function(){return this._settingsWindow.AddButtons([])},_onPopupWindowToolbarButtonClicked:function(n,t){var u,r,f,i;this._popupWindowComponent&&(u=jQuery.extend(this._eventsArgs,t),r=this._settingsWindow.Validate(),r.length==0?(u.isSettingsSet=!0,f=$("#"+this._popupWindowComponent._documentWrapperElementId+" form input, #"+this._popupWindowComponent._documentWrapperElementId+" form select").serialize(),i=this,$.ajax({url:i._settingsActionUrl.replace("Settings","SetupWithParams"),data:f,type:"POST",success:function(n){n.view==null?(i._popupWindowComponent.closeWindow(),$(".t-overlay").remove(),i._callback({isSettingsSet:!0})):$("#"+i._popupWindowComponent._documentWrapperElementId).html(n.view)}})):alert(r))},_popupWindowClosedHandler:function(){this._settingsWindow.dispose();Quantumart.QP8.BackendSettingsPopupWindow.callBaseMethod(this,"dispose")}};Quantumart.QP8.BackendSettingsPopupWindow.registerClass("Quantumart.QP8.BackendSettingsPopupWindow",Quantumart.QP8.BackendSelectPopupWindow);