Quantumart.QP8.BackendEntitySingleItemPicker=function(n,t,i,r,u,f,e){Quantumart.QP8.BackendEntitySingleItemPicker.initializeBase(this,[n,t,i,r,u,f,e]);this._allowMultipleItemSelection=!1;this._selectionMode=Quantumart.QP8.Enums.ListSelectionMode.OnlySelectedItems};Quantumart.QP8.BackendEntitySingleItemPicker.prototype={_displayFieldElement:null,_stateFieldElement:null,_pickButtonElement:null,_deselectButtonElement:null,DISPLAY_FIELD_CLASS_NAME:"displayField",STATE_FIELD_CLASS_NAME:"stateField",initialize:function(){var n,t,u,f;Quantumart.QP8.BackendEntitySingleItemPicker.callBaseMethod(this,"initialize");var e=jQuery(this._listElement),i=e.find("."+this.DISPLAY_FIELD_CLASS_NAME),r=e.find("INPUT."+this.STATE_FIELD_CLASS_NAME+":first");r.addClass("qp-notChangeTrack");n=this._createToolbarButton(this._listElementId+"_PickButton",$l.EntityDataList.pickSingleLinkButtonText,"pick");this._addButtonToToolbar(n);t=this._createToolbarButton(this._listElementId+"_DeselectButton",$l.EntityDataList.deselectLinkButtonText,"deselectAll");this._addButtonToToolbar(t);this._enableCopy&&(u=this._createToolbarButton(this._listElementId+"_CopyButton",$l.EntityDataList.copyLinkButtonText,"copy"),this._addButtonToToolbar(u),f=this._createToolbarButton(this._listElementId+"_PasteButton",$l.EntityDataList.pasteLinkButtonText,"paste"),this._addButtonToToolbar(f));this._displayFieldElement=i.get(0);this._stateFieldElement=r.get(0);this._pickButtonElement=n.get(0);this._deselectButtonElement=t.get(0);r.bind("change",jQuery.proxy(this._onSelectedItemChangeHandler,this));n.bind("click",jQuery.proxy(this._onPickButtonClickHandler,this));t.bind("click",jQuery.proxy(this._onDeselectButtonClickHandler,this));i.delegate("A","click",jQuery.proxy(this._onItemClickHandler,this));i.delegate("A","mouseup",jQuery.proxy(this._onItemClickHandler,this));this._enableCopy&&(this._copyButtonElement=u.get(0),u.bind("click",jQuery.proxy(this._onCopyButtonClickHandler,this)),this._pasteButtonElement=f.get(0),f.bind("click",jQuery.proxy(this._onPasteButtonClickHandler,this)));this._showIds||this._addReadButtonToToolbar();this._addNewButtonToToolbar();e=null;i=null;r=null;n=null;t=null},getListItemCount:function(){return 1},getSelectedListItemCount:function(){var n=0,t=jQuery(this._stateFieldElement),i;return $q.isNullOrEmpty(t)||(i=$q.toInt(t.val(),0),i!=0&&(n=1)),n},getSelectedEntities:function(){var t=[],i=jQuery(this._stateFieldElement),r=jQuery(this._displayFieldElement),n,u;return $q.isNullOrEmpty(i)||$q.isNullOrEmpty(r)||(n=$q.toInt(i.val(),0),u=$q.toString(r.find(".title").html(),""),n!=0&&Array.add(t,{Id:n,Name:u})),t},getStateFieldElement:function(){return this._stateFieldElement},_refreshListInner:function(n,t){var f="",r="",u,i,e,o;$q.isNullOrEmpty(n)||(r=n[0].Value,f=this._getIdLinkCode(r)+'<span class="title">'+n[0].Text+"<\/span>");u=jQuery(this._displayFieldElement);i=jQuery(this._stateFieldElement);u.html(f);e=i.val();i.val(r);e!=r&&(i.addClass(CHANGED_FIELD_CLASS_NAME),o=t?"addClass":"removeClass",i[o](REFRESHED_FIELD_CLASS_NAME),i.trigger(JQ_CUSTOM_EVENT_ON_FIELD_CHANGED,{fieldName:i.attr("name"),value:r}),i.change());u=null;i=null},deselectAllListItems:function(){this._refreshListInner([]);var n=new Quantumart.QP8.BackendEventArgs;this.notify(EVENT_TYPE_ENTITY_LIST_SELECTION_CHANGED,n)},selectEntities:function(n){if(this.deselectAllListItems(),!$q.isNullOrEmpty(n))if($q.isArray(n)&&n.length>0)this.selectEntities(n[0]);else if($q.isInt(n)){var t=jQuery.map([n],function(n){return{Id:n}});this._loadSelectedItems(t);t=null}},enableList:function(){jQuery(this._listElement).removeClass(this.LIST_DISABLED_CLASS_NAME);jQuery(this._stateFieldElement).prop("disabled",!1);this._enableAllToolbarButtons()},disableList:function(){jQuery(this._listElement).addClass(this.LIST_DISABLED_CLASS_NAME);jQuery(this._stateFieldElement).prop("disabled",!0);this._disableAllToolbarButtons()},makeReadonly:function(){this.disableList();jQuery(this._stateFieldElement).prop("disabled",!1)},isListChanged:function(){var n=jQuery(this._stateFieldElement),t=n.hasClass(CHANGED_FIELD_CLASS_NAME);return n=null,t},_onSelectedItemChangeHandler:function(){this.isListDisabled()||this._refreshReadToolbarButton(!0)},_onPickButtonClickHandler:function(n){this.isListDisabled()||this._openPopupWindow();n.stopImmediatePropagation()},_onDeselectButtonClickHandler:function(n){this.isListDisabled()||this.deselectAllListItems();n.stopImmediatePropagation()},dispose:function(){this._stopDeferredOperations=!0;jQuery(this._stateFieldElement).unbind("change");jQuery(this._pickButtonElement).unbind("click");jQuery(this._deselectButtonElement).unbind("click");jQuery(this._displayFieldElement).undelegate("click");jQuery(this._displayFieldElement).undelegate("mouseup");this._enableCopy&&(jQuery(this._copyButtonElement).unbind("click"),jQuery(this._pasteButtonElement).unbind("click"));this._stateFieldElement=null;this._displayFieldElement=null;this._pickButtonElement=null;this._deselectButtonElement=null;this._copyButtonElement=null;this._pasteButtonElement=null;Quantumart.QP8.BackendEntitySingleItemPicker.callBaseMethod(this,"dispose")}};Quantumart.QP8.BackendEntitySingleItemPicker.registerClass("Quantumart.QP8.BackendEntitySingleItemPicker",Quantumart.QP8.BackendEntityDataListBase);