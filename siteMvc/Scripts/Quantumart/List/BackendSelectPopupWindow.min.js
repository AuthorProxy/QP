var EVENT_TYPE_SELECT_POPUP_WINDOW_RESULT_SELECTED="OnSelectPopupWindowResultSelected",EVENT_TYPE_SELECT_POPUP_WINDOW_CLOSED="OnSelectPopupWindowClosed";Quantumart.QP8.BackendSelectPopupWindow=function(n,t){Quantumart.QP8.BackendSelectPopupWindow.initializeBase(this);var i=Quantumart.QP8.BackendPopupWindowManager.getInstance();this._popupWindowId=i.generatePopupWindowId();this._isMultipleEntities=n.get_isMultipleEntities();this._actionCode=n.get_actionCode();this._entityTypeCode=n.get_entityTypeCode();this._parentEntityId=n.get_parentEntityId();this._popupWindowToolbarComponent=this._createToolbar();t=jQuery.extend(t,{popupWindowId:this._popupWindowId,showBreadCrumbs:!1,saveSelectionWhenChangingView:!0,customActionToolbarComponent:this._popupWindowToolbarComponent,isModal:!0,allowResize:!1,allowDrag:!1});n.set_actionTypeCode(Quantumart.QP8.BackendActionType.getActionTypeCodeByActionCode(this._actionCode));this._popupWindowComponent=i.createPopupWindow(n,t);this._popupWindowComponent.attachObserver(EVENT_TYPE_POPUP_WINDOW_CLOSED,jQuery.proxy(this._onClosed,this));this._popupWindowComponent.attachObserver(EVENT_TYPE_POPUP_WINDOW_CLOSED,jQuery.proxy(this._popupWindowClosedHandler,this))};Quantumart.QP8.BackendSelectPopupWindow.prototype={_isMultipleEntities:!1,_popupWindowId:"",_popupWindowToolbarComponent:null,_popupWindowComponent:null,_allowMultipleItemSelection:!1,SELECT_BUTTON_CODE:"select",SELECT_ALL_BUTTON_CODE:"select_all",DESELECT_ALL_BUTTON_CODE:"deselect_all",REFRESH_BUTTON_CODE:"refresh",_onPopupWindowToolbarButtonClicked:function(n,t,i){var r,u,f;this._popupWindowComponent&&(r=i.get_value(),r==this.SELECT_BUTTON_CODE?(u=this._popupWindowComponent.get_selectedEntities(),f=this._popupWindowComponent.get_selectionContext(),this.notify(EVENT_TYPE_SELECT_POPUP_WINDOW_RESULT_SELECTED,{entities:u,context:f})):r==this.SELECT_ALL_BUTTON_CODE?this._popupWindowComponent.selectAllEntities():r==this.DESELECT_ALL_BUTTON_CODE?this._popupWindowComponent.deselectAllEntities():r==this.REFRESH_BUTTON_CODE&&this._popupWindowComponent.refresh())},_onClosed:function(){this._popupWindowComponent=null;var n=new Quantumart.QP8.BackendEventArgs;this.notify(EVENT_TYPE_SELECT_POPUP_WINDOW_CLOSED,n);n=null},_createToolbar:function(){var n=new Quantumart.QP8.BackendToolbar;return n.set_toolbarElementId("popupWindowToolbar_"+this._popupWindowId),n.initialize(),n.attachObserver(EVENT_TYPE_TOOLBAR_BUTTON_CLICKED,jQuery.proxy(this._onPopupWindowToolbarButtonClicked,this)),n.addToolbarItemsToToolbar(this._getToolbarItems()),n},_getToolbarItems:function(){var n=[],u={Type:TOOLBAR_ITEM_TYPE_BUTTON,Value:this.SELECT_BUTTON_CODE,Text:$l.EntityDataList.selectPopupWindowButtonText,Tooltip:$l.EntityDataList.selectPopupWindowButtonText,AlwaysEnabled:!0,Icon:"multiple_pick.gif"},t,i,r;return Array.add(n,u),this._isMultipleEntities&&(t={Type:TOOLBAR_ITEM_TYPE_BUTTON,Value:this.SELECT_ALL_BUTTON_CODE,Text:$l.EntityDataList.selectAllPopupWindowButtonText,Tooltip:$l.EntityDataList.selectAllPopupWindowButtonText,AlwaysEnabled:!0,Icon:"select_all.gif"},Array.add(n,t),i={Type:TOOLBAR_ITEM_TYPE_BUTTON,Value:this.DESELECT_ALL_BUTTON_CODE,Text:$l.EntityDataList.deselectAllPopupWindowButtonText,Tooltip:$l.EntityDataList.deselectAllPopupWindowButtonText,AlwaysEnabled:!0,Icon:"deselect_all.gif"},Array.add(n,i)),r={Type:TOOLBAR_ITEM_TYPE_BUTTON,Value:this.REFRESH_BUTTON_CODE,Text:$l.EntityDataList.refreshPopupWindowButtonText,Tooltip:$l.EntityDataList.refreshPopupWindowButtonText,AlwaysEnabled:!0,Icon:"refresh.gif"},Array.add(n,r),n},openWindow:function(){this._popupWindowComponent&&this._popupWindowComponent.openWindow()},closeWindow:function(){this._popupWindowComponent&&this._popupWindowComponent.closeWindow()},_popupWindowClosedHandler:function(){this.dispose()},dispose:function(){this._popupWindowToolbarComponent&&(this._popupWindowToolbarComponent.detachObserver(EVENT_TYPE_TOOLBAR_BUTTON_CLICKED),this._popupWindowToolbarComponent.dispose(),this._popupWindowToolbarComponent=null);this._popupWindowComponent&&(this._popupWindowComponent.detachObserver(EVENT_TYPE_POPUP_WINDOW_CLOSED),this._popupWindowComponent.dispose(),this._popupWindowComponent=null)}};Quantumart.QP8.BackendSelectPopupWindow.registerClass("Quantumart.QP8.BackendSelectPopupWindow",Quantumart.QP8.Observable);