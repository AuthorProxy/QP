var EVENT_TYPE_ACTION_TOOLBAR_BUTTON_CLICKING="OnActionToolbarButtonClicking",EVENT_TYPE_ACTION_TOOLBAR_BUTTON_CLICKED="OnActionToolbarButtonClicked";Quantumart.QP8.BackendActionToolbar=function(n,t,i,r){Quantumart.QP8.BackendActionToolbar.initializeBase(this,[n,r]);this._actionCode=t;this._parentEntityId=i;$q.isObject(r)&&(r.alwaysEnabledRefreshButton&&(this._alwaysEnabledRefreshButton=r.alwaysEnabledRefreshButton),r.disabledActionCodes&&(this._disabledActionCodes=r.disabledActionCodes))};Quantumart.QP8.BackendActionToolbar.prototype={_actionCode:"",_entityId:0,_parentEntityId:0,_alwaysEnabledRefreshButton:!0,_stopDeferredOperations:!1,_disabledActionCodes:null,get_actionCode:function(){return this._actionCode},set_actionCode:function(n){this._actionCode=n},get_entityId:function(){return this._entityId},set_entityId:function(n){this._entityId=n},get_parentEntityId:function(){return this._parentEntityId},set_parentEntityId:function(n){this._parentEntityId=n},get_alwaysEnabledRefreshButton:function(){return this._alwaysEnabledRefreshButton},set_alwaysEnabledRefreshButton:function(n){this._alwaysEnabledRefreshButton=n},addToolbarItemsToToolbar:function(n){var t=this,i={actionCode:this._actionCode,entityId:this._entityId,parentEntityId:this._parentEntityId};this.get_isBindToExternal()===!0&&(i=jQuery.extend(i,{boundToExternal:!0}));$q.getJsonFromUrl("GET",CONTROLLER_URL_TOOLBAR+"GetToolbarButtonListByActionCode",i,!1,!1,function(i){var r,u;if(!t._stopDeferredOperations){r=i;$q.isNullOrEmpty(t.getDisabledActionCodes())||(r=jQuery.grep(r,function(n){return t.getDisabledActionCodes().indexOf(n.ActionCode)==-1}));u=t._getToolbarItemsFromResult(r);Quantumart.QP8.BackendActionToolbar.callBaseMethod(t,"addToolbarItemsToToolbar",[u,n]);$q.clearArray(u);$q.clearArray(r);return}},function(n){t._stopDeferredOperations||$q.processGenericAjaxError(n)})},tuneToolbarItems:function(n,t){var i=this,r={actionCode:this._actionCode,entityId:n,parentEntityId:t};this.get_isBindToExternal()===!0&&(r=jQuery.extend(r,{boundToExternal:!0}));n!=0&&$q.getJsonFromUrl("GET",CONTROLLER_URL_BACKEND_ACTION+"GetStatusesList",r,!0,!1).done(function(n){if(!i._stopDeferredOperations)if(n.success){var t=n.actionStatuses;if(!$q.isNullOrEmpty(t)){Quantumart.QP8.BackendActionToolbar.callBaseMethod(i,"tuneToolbarItems",[t]);$q.clearArray(t);return}}else alert(n.Text)}).fail(function(n){i._stopDeferredOperations||$q.processGenericAjaxError(n)})},notifyToolbarButtonClicked:function(n){this.notify(EVENT_TYPE_ACTION_TOOLBAR_BUTTON_CLICKED,n)},setDisabledActionCodes:function(n){this._disabledActionCodes=n},getDisabledActionCodes:function(){return this._disabledActionCodes},_getToolbarItemsFromResult:function(n){var i=this,t=[];return jQuery.each(n,function(n,i){var r={};r.Type=TOOLBAR_ITEM_TYPE_BUTTON;r.Value=i.ActionCode;r.Text=i.Name;r.Tooltip=i.Name;r.ItemsAffected=i.ItemsAffected;r.Icon=i.Icon;r.AlwaysEnabled=i.ItemsAffected==0;r.CheckOnClick=!1;r.Checked=!1;r.IconChecked=null;Array.add(t,r)}),t},dispose:function(){this._stopDeferredOperations=!0;Quantumart.QP8.BackendActionToolbar.callBaseMethod(this,"dispose");$q.collectGarbageInIE()}};Quantumart.QP8.BackendActionToolbar.registerClass("Quantumart.QP8.BackendActionToolbar",Quantumart.QP8.BackendToolbar);