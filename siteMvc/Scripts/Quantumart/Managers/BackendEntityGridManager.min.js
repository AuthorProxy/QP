Quantumart.QP8.BackendEntityGridManager=function(){Quantumart.QP8.BackendEntityGridManager.initializeBase(this)};Quantumart.QP8.BackendEntityGridManager.prototype={_gridGroups:{},generateGridGroupCode:function(n,t){return t?String.format("{0}_{1}",n,t):n},getGridGroup:function(n){var t=null;return this._gridGroups[n]&&(t=this._gridGroups[n]),t},createGridGroup:function(n){var t=this.getGridGroup(n);return t||(t={},this._gridGroups[n]=t),t},refreshGridGroup:function(n,t,i){var r=this.getGridGroup(this.generateGridGroupCode(n,t)),u;if(r)for(u in r)this.refreshGrid(u,i);r=null},refreshGridGroupWithChecking:function(n,t,i){var u=this.getGridGroup(this.generateGridGroupCode(n,t)),f,r;if(u)for(f in u)r=this.getGrid(f),r&&r.checkExistEntityInCurrentPage(i)&&r.refreshGrid()},resetGridGroup:function(n,t){var i=this.getGridGroup(n),r;if(i)for(r in i)this.resetGrid(r,t);i=null},removeGridGroup:function(n){$q.removeProperty(this._gridGroups,n)},getGrid:function(n){var i=null,r,t;for(r in this._gridGroups)if(t=this._gridGroups[r],t[n]){i=t[n];break}return i},createGrid:function(n,t,i,r,u,f){var s=this.generateGridGroupCode(t,i),h=this.generateGridGroupCode(r,i),c=this.generateGridGroupCode(r),o=new Quantumart.QP8.BackendEntityGrid([s,h,c],n,t,i,r,u,f),e;return o.set_gridManager(this),e=this.createGridGroup(s),e[n]=o,e=this.createGridGroup(h),e[n]=o,e=this.createGridGroup(c),e[n]=o,o},refreshGrid:function(n,t){var i=this.getGrid(n);i&&i.refreshGrid(t);i=null},resetGrid:function(n,t){var i=this.getGrid(n);i&&i.resetGrid(t);i=null},removeGrid:function(n){var i=this.getGrid(n),r,t;i&&(r=i.get_gridGroupCodes(),t=this,jQuery.each(r,function(i,r){var u=t.getGridGroup(r);$q.removeProperty(u,n);$q.getHashKeysCount(u)==0&&t.removeGridGroup(r)}))},destroyGrid:function(n){var t=this.getGrid(n);t!=null&&(t.dispose&&t.dispose(),t=null)},onActionExecuted:function(n){var t=n.get_entityTypeCode(),f,e;if(t!=ENTITY_TYPE_CODE_SITE_FILE&&t!=ENTITY_TYPE_CODE_CONTENT_FILE){var r=n.get_parentEntityId(),i=n.get_actionTypeCode(),o=n.get_actionCode(),u=n.get_entityId();n.get_isSaved()||i==ACTION_TYPE_CODE_COPY||i==ACTION_TYPE_CODE_MULTIPLE_UNLOCK||n.get_isRemoving()||n.get_isArchiving()||n.get_isRestoring()||o==ACTION_CODE_MULTIPLE_PUBLISH_ARTICLES?(f=null,(n.get_isArchiving()||n.get_isRestoring()||n.get_isRemoving()||i==ACTION_TYPE_CODE_MULTIPLE_UNLOCK)&&(e=n.get_isMultipleEntities()?$o.getEntityIDsFromEntities(n.get_entities()):[n.get_entityId()],f={removedIds:e}),this.refreshGridGroup(t,r,f)):(n.get_isUpdated()||n.get_isLoaded()||i==ACTION_TYPE_CODE_CANCEL||i==ACTION_TYPE_CODE_CHANGE_LOCK)&&this.refreshGridGroupWithChecking(t,r,u);n.get_isUpdated()&&t==ENTITY_TYPE_CODE_ARTICLE?this.refreshGridGroup(ENTITY_TYPE_CODE_ARTICLE_VERSION,u):(n.get_isArchiving()||n.get_isRemoving())&&t==ENTITY_TYPE_CODE_ARTICLE?this.refreshGridGroup(ENTITY_TYPE_CODE_ARCHIVE_ARTICLE,r):n.get_isRestoring()&&t==ENTITY_TYPE_CODE_ARCHIVE_ARTICLE?this.refreshGridGroup(ENTITY_TYPE_CODE_ARTICLE,r):n.get_isRestored()&&t==ENTITY_TYPE_CODE_ARTICLE_VERSION?(r=$q.toInt($o.getParentEntityId(ENTITY_TYPE_CODE_ARTICLE,u),0),this.refreshGridGroup(ENTITY_TYPE_CODE_ARTICLE,r)):i==ACTION_TYPE_CHILD_ENTITY_PERMISSION_SAVE||i==ACTION_TYPE_CHILD_ENTITY_MULTIPLE_REMOVE||i==ACTION_TYPE_CHILD_ENTITY_REMOVE_ALL||i==ACTION_TYPE_CHILD_ENTITY_REMOVE?t==ENTITY_TYPE_CODE_CONTENT_PERMISSION?(this.refreshGridGroup(ACTION_CODE_CHILD_CONTENT_PERMISSIONS,r),this.refreshGridGroup(ACTION_CODE_CONTENT_PERMISSIONS)):t==ENTITY_TYPE_CODE_ARTICLE_PERMISSION&&(this.refreshGridGroup(ACTION_CODE_CHILD_ARTICLE_PERMISSIONS,r),this.refreshGridGroup(ACTION_CODE_ARTICLE_PERMISSIONS)):(n.get_isSaved()||n.get_isUpdated()||n.get_isRemoving())&&(t==ENTITY_TYPE_CODE_CONTENT_PERMISSION?this.refreshGridGroup(ACTION_CODE_CHILD_CONTENT_PERMISSIONS):t==ENTITY_TYPE_CODE_ARTICLE_PERMISSION&&this.refreshGridGroup(ACTION_CODE_CHILD_ARTICLE_PERMISSIONS))}},dispose:function(){if(Quantumart.QP8.BackendEntityGridManager.callBaseMethod(this,"dispose"),this._gridGroups){for(gridGroupCode in this._gridGroups){var n=this._gridGroups[gridGroupCode];for(gridElementId in n)this.destroyGrid(gridElementId)}this._gridGroups=null}Quantumart.QP8.BackendEntityGridManager._instance=null;$q.collectGarbageInIE()}};Quantumart.QP8.BackendEntityGridManager._instance=null;Quantumart.QP8.BackendEntityGridManager.getInstance=function(){return Quantumart.QP8.BackendEntityGridManager._instance==null&&(Quantumart.QP8.BackendEntityGridManager._instance=new Quantumart.QP8.BackendEntityGridManager),Quantumart.QP8.BackendEntityGridManager._instance};Quantumart.QP8.BackendEntityGridManager.destroyInstance=function(){Quantumart.QP8.BackendEntityGridManager._instance&&Quantumart.QP8.BackendEntityGridManager._instance.dispose()};Quantumart.QP8.BackendEntityGridManager.registerClass("Quantumart.QP8.BackendEntityGridManager",Quantumart.QP8.Observable);