(function(n,t){function u(n){return n&&!/^([a-z]+:)?\/\//i.test(n)}function r(t){n.browser.msie&&n.browser.version<7&&t.find(".t-resize-e,.t-resize-w").css("height",t.height()).end().find(".t-resize-n,.t-resize-s").css("width",t.width()).end().find(".t-overlay").css({width:t.width(),height:t.height()})}var i=n.telerik;i.scripts.push("telerik.window.js"),i.fx.zoom=function(n){this.element=n},i.fx.zoom.prototype={play:function(n,t){var r=this.element.show(),u=r.find("> .t-window-content"),i={width:u.width(),height:u.height(),left:parseInt(r.css("left"))||0,top:parseInt(r.css("top"))||0};r.css({left:i.left+20,top:i.top+20}).animate({left:i.left,top:i.top},n.openDuration),u.css({width:i.width-40,height:i.height-40}).animate({width:i.width,height:i.height},n.openDuration,function(){t&&t()})},rewind:function(n,t){var r=this.element,u=r.find("> .t-window-content"),i={width:u.width(),height:u.height(),left:parseInt(r.css("left")),top:parseInt(r.css("top"))};u.animate({width:i.width-40,height:i.height-40},n.closeDuration),r.animate({left:i.left+20,top:i.top+20},n.closeDuration,function(){r.css({left:i.left,top:i.top}).hide(),setTimeout(function(){u.css({width:i.width,height:i.height})},0),t&&t()})}},i.fx.zoom.defaults=function(){return{list:[{name:"zoom"}],openDuration:"fast",closeDuration:"fast"}},i.window=function(f,e){var o,c,s,l,h;this.element=f,o=n(f),c=n.extend({},e),delete c.title,delete c.content,n.extend(this,c),o.is(".t-window")||(o.addClass("t-widget t-window"),i.window.create(f,e)),o.is("body")||(o.is(":visible")?(s=o.offset(),o.css({top:s.top,left:s.left})):(o.css({visibility:"hidden",display:""}),s=o.offset(),o.css({top:s.top,left:s.left}).css({visibility:"visible",display:"none"})),l=o.find("iframe").map(function(){var t=this.getAttribute("src");return this.src="",t}),o.toggleClass("t-rtl",o.closest(".t-rtl").length>0).appendTo(document.body).find("iframe").each(function(n){this.src=l[n]})),this.bringToTop(),o.find(".t-window-titlebar").andSelf().bind("mousedown",n.proxy(this.bringToTop,this)),this.modal&&o.is(":visible")&&this.overlay(!0).css({opacity:.5,zIndex:parseInt(o.css("zIndex"),10)-1}),h=".t-window-titlebar .t-link",o.delegate(h,"mouseenter",i.hover).delegate(h,"mouseleave",i.leave).delegate(h,"click",n.proxy(this.windowActionHandler,this)),this.resizable&&(o.delegate(".t-window-titlebar","dblclick",n.proxy(this.toggleMaximization,this)).append(i.window.getResizeHandlesHtml()),r(o),(function(t){function e(i){var r=n(t.element);t.initialCursorPosition=r.offset(),t.resizeDirection=/t-resize-([nesw]+)/gi.exec(i.$draggable[0].className)[1],t.resizeElement=r.find("> .t-window-content"),t.initialSize={width:t.resizeElement.width(),height:t.resizeElement.height()},t.outlineSize={left:t.resizeElement.outerWidth()-t.resizeElement.width()+r.outerWidth()-r.width(),top:t.resizeElement.outerHeight()-t.resizeElement.height()+r.outerHeight()-r.height()+r.find("> .t-window-titlebar").outerHeight()},n('<div class="t-overlay" />').appendTo(t.element),r.find(".t-resize-handle").not(i.$draggable).hide(),n(document.body).css("cursor",i.$draggable.css("cursor"))}function f(u){var f=n(t.element),e={e:function(){var r=i.touchLocation(u),n=r.x-t.initialCursorPosition.left-t.outlineSize.left;t.resizeElement.width(n<t.minWidth?t.minWidth:t.maxWidth&&n>t.maxWidth?t.maxWidth:n)},s:function(){var r=i.touchLocation(u),n=r.y-t.initialCursorPosition.top-t.outlineSize.top;t.resizeElement.height(n<t.minHeight?t.minHeight:t.maxHeight&&n>t.maxHeight?t.maxHeight:n)},w:function(){var e=i.touchLocation(u),n=t.initialCursorPosition.left+t.initialSize.width,r;f.css("left",e.x>n-t.minWidth?n-t.minWidth:e.x<n-t.maxWidth?n-t.maxWidth:e.x),r=n-e.x,t.resizeElement.width(r<t.minWidth?t.minWidth:t.maxWidth&&r>t.maxWidth?t.maxWidth:r)},n:function(){var e=i.touchLocation(u),n=t.initialCursorPosition.top+t.initialSize.height,r;f.css("top",e.y>n-t.minHeight?n-t.minHeight:e.y<n-t.maxHeight?n-t.maxHeight:e.y),r=n-e.y,t.resizeElement.height(r<t.minHeight?t.minHeight:t.maxHeight&&r>t.maxHeight?t.maxHeight:r)}};n.each(t.resizeDirection.split(""),function(){e[this]()}),r(f),n.browser.msie&&parseInt(n.browser.version)>=9&&(f[0].style.cssText=f[0].style.cssText),i.trigger(t.element,"resize")}function u(i){var u=n(t.element);return u.find(".t-overlay").remove().end().find(".t-resize-handle").not(i.$draggable).show(),n(document.body).css("cursor",""),i.keyCode==27&&(r(u),u.css(t.initialCursorPosition),t.resizeElement.css(t.initialSize)),!1}new i.draggable({owner:t.element,selector:".t-resize-handle",scope:t.element.id+"-resizing",distance:0,start:e,drag:f,stop:u})})(this)),this.draggable&&(function(r){function o(u){var o=n(r.element),s=i.touchLocation(u),e;r.initialWindowPosition=o.position(),i.trigger(f,"dragStart"),r.startPosition={left:s.x-r.initialWindowPosition.left,top:s.y-r.initialWindowPosition.top},e=o.find(".t-window-actions"),e.length>0?(r.isRtl==t&&(r.isRtl=n(r.element).closest(".t-rtl").length>0),r.minLeftPosition=e.outerWidth()+parseInt(e.css(r.isRtl?"left":"right"),10)-o.outerWidth()):r.minLeftPosition=20-o.outerWidth(),n(".t-resize-handle",r.element).hide(),n('<div class="t-overlay" />').appendTo(r.element),n(document.body).css("cursor",u.$draggable.css("cursor"))}function e(t){var u=i.touchLocation(t),f={left:Math.max(u.x-r.startPosition.left,r.minLeftPosition),top:Math.max(u.y-r.startPosition.top,0)};n(r.element).css(f)}function u(t){return n(r.element).find(".t-resize-handle").show().end().find(".t-overlay").remove(),n(document.body).css("cursor",""),t.keyCode==27&&t.$draggable.closest(".t-window").css(r.initialWindowPosition),i.trigger(f,"dragEnd"),!1}new i.draggable({owner:r.element,selector:".t-window-titlebar",scope:r.element.id+"-moving",start:o,drag:e,stop:u})})(this),i.bind(this,{open:this.onOpen,activated:this.onActivate,close:this.onClose,refresh:this.onRefresh,resize:this.onResize,error:this.onError,load:this.onLoad,dragStart:this.onDragStart,dragEnd:this.onDragEnd}),n(window).resize(n.proxy(this.onDocumentResize,this)),u(this.contentUrl)&&this.ajaxRequest()},i.window.prototype={overlay:function(t){var i=n("body > .t-overlay"),r=this.element;return i.length==0?i=n('<div class="t-overlay" />').toggle(t).insertBefore(r):i.insertBefore(r).toggle(t),this.positionOverlay(i),i},positionOverlay:function(t){var i=n(document);n.browser.msie&&n.browser.version<7?t.css({width:i.width()-21,height:i.height(),position:"absolute"}):/ipad/gi.test(navigator.appVersion)&&t.css({width:i.width(),height:i.height(),position:"absolute"})},overlayOnClose:function(i){var r=this,e=n(".t-window").filter(function(){var t=n(this);return this!==r.element&&t.is(":visible")&&t.data("tWindow").modal}),h=r.modal&&e.length==0,u=r.modal?r.overlay(!0):n(t),c,f,o,s;h?r.effects.list.length>0&&r.effects.list[0].name!="toggle"?u.fadeOut(r.effects.closeDuration,function(){i&&u.remove()}):i?u.remove():u.hide():e.length>0&&(c=parseInt(n(".t-overlay").css("zIndex"),10),f=0,e.each(function(t,i){var r=parseInt(n(i).css("zIndex"),10);r<f||(f=r,o=n(i))}),s=o.data("tWindow"),s.overlay(!0).css("zIndex",f-1))},windowActionHandler:function(t){var r=n(t.target).closest(".t-link").find(".t-icon"),i=this;n.each({"t-close":this.close,"t-maximize":this.maximize,"t-restore":this.restore,"t-refresh":this.refresh},function(n,u){if(r.hasClass(n))return t.preventDefault(),u.call(i),!1})},center:function(){var i=n(this.element),t=n(window);return i.css({left:t.scrollLeft()+Math.max(0,(t.width()-i.width())/2),top:t.scrollTop()+Math.max(0,(t.height()-i.height())/2)}),this},title:function(t){var i=n(".t-window-titlebar > .t-window-title",this.element);return t?(i.text(t),this):i.text()},content:function(t){var i=n("> .t-window-content",this.element);return t?(i.html(t),this):i.html()},bringToTop:function(){var f=this,i=f.element,r=parseInt(n(i).css("zIndex"),10),t=r,e=10001,u=n(".t-window").filter(":visible");if(u.length!=1||!n(i).is(":visible"))return u.each(function(){var r=n(this),u=r.css("zIndex");isNaN(u)||(t=Math.max(parseInt(u,10),t)),this!=i&&r.find(".t-window-content > iframe").length>0&&r.find(".t-window-content").append("<div class='t-overlay' />")}),(r==e||t>r)&&n(i).css("zIndex",t+2).find(".t-window-content > .t-overlay").remove(),f},open:function(){var r=n(this.element),u;return this.bringToTop(),i.trigger(this.element,"open")||(this.modal&&(u=this.overlay(!1).css("zIndex",parseInt(r.css("zIndex"),10)-1),this.effects.list.length>0&&this.effects.list[0].name!="toggle"?u.css("opacity",0).show().animate({opacity:.5},this.effects.openDuration):u.css("opacity",.5).show()),r.is(":visible")||i.fx.play(this.effects,r,{},function(){i.trigger(r[0],"activated")})),this.isMaximized&&(this._documentScrollTop=n(document).scrollTop(),n("html, body").css("overflow","hidden")),this},close:function(){var t=n(this.element);return t.is(":visible")&&(i.trigger(this.element,"close")||(this.overlayOnClose(),i.fx.rewind(this.effects,t,null,function(){t.hide()}))),this.isMaximized&&(n("html, body").css("overflow",""),this._documentScrollTop&&this._documentScrollTop>0&&n(document).scrollTop(this._documentScrollTop)),this},toggleMaximization:function(t){if(t&&n(t.target).closest(".t-link").length>0)return;this[this.isMaximized?"restore":"maximize"]()},restore:function(){if(this.isMaximized)return n(this.element).css({position:"absolute",left:this.restorationSettings.left,top:this.restorationSettings.top}).find("> .t-window-content").css({width:this.restorationSettings.width,height:this.restorationSettings.height}).end().find(".t-resize-handle").show().end().find(".t-window-titlebar .t-restore").addClass("t-maximize").removeClass("t-restore"),n("html, body").css("overflow",""),this._documentScrollTop&&this._documentScrollTop>0&&n(document).scrollTop(this._documentScrollTop),this.isMaximized=!1,i.trigger(this.element,"resize"),this},maximize:function(){if(this.isMaximized)return;var i=n(this.element),r=i.find("> .t-window-content");return this.restorationSettings={left:i.position().left,top:i.position().top,width:r.width(),height:r.height()},i.css({left:0,top:0,position:"fixed"}).find(".t-resize-handle").hide().end().find(".t-window-titlebar .t-maximize").addClass("t-restore").removeClass("t-maximize"),this._documentScrollTop=n(document).scrollTop(),n("html, body").css("overflow","hidden"),this.isMaximized=!0,this.onDocumentResize(),this},onDocumentResize:function(){if(!this.isMaximized)return;var t=n(this.element),u=t.find("> .t-window-content");u.css({width:n(window).width()-(u.outerWidth()-u.width()+t.outerWidth()-t.width()),height:n(window).height()-(u.outerHeight()-u.height()+t.outerHeight()-t.height()+t.find("> .t-window-titlebar").outerHeight())}),r(t),i.trigger(t,"resize")},refresh:function(){if(u(this.contentUrl))this.ajaxRequest();else{var t=n(this.element).find("> .t-window-content > iframe")[0];t&&(t.src=t.src)}return this},ajaxRequest:function(t,r){var u=setTimeout(function(){n(".t-refresh",this.element).addClass("t-loading")},100);n.ajax({type:"GET",url:t||this.contentUrl,dataType:"html",data:r||{},cache:!1,error:n.proxy(function(n,t){i.ajaxError(this.element,"error",n,t)},this),complete:function(){clearTimeout(u),n(".t-refresh",this.element).removeClass("t-loading")},success:n.proxy(function(t){n(".t-window-content",this.element).html(t),i.trigger(this.element,"refresh")},this)})},destroy:function(){n(this.element).remove(),this.overlayOnClose(!0)}},n.extend(i.window,{create:function(){var o,r,e,f;n.isPlainObject(arguments[0])?r=arguments[0]:(o=arguments[0],r=n.extend({html:o.innerHTML},arguments[1])),r=n.extend({title:"",html:"",actions:["Close"],visible:!0},r),e=r.contentUrl,f=(new i.stringBuilder).catIf('<div class="t-widget t-window">',!o).cat('<div class="t-window-titlebar t-header">').cat('&nbsp;<span class="t-window-title">').cat(r.title).cat("</span>").cat('<div class="t-window-actions t-header">'),n.map(r.actions,function(n){f.cat('<a href="#" class="t-link">').cat('<span class="t-icon t-').cat(n.toLowerCase()).cat('">').cat(n).cat("</span></a>")}),f.cat("</div></div>").cat('<div class="t-window-content t-content" style="'),r.width&&f.cat("width:").cat(r.width).cat("px;"),r.height&&f.cat("height:").cat(r.height).cat("px;"),typeof r.scrollable!=typeof t&&r.scrollable===!1&&f.cat("overflow:hidden;"),f.cat('">').catIf(r.html,!e||e&&u(e)).catIf('<iframe src="',e,'" title="',r.title,'" frameborder="0" style="border:0;width:100%;height:100%;">This page requires frames in order to show content</iframe>',e&&!u(e)).cat("</div>").catIf("</div>",!o);if(o)n(o).css("display",r.visible?"":"none").html(f.string());else return delete r.title,n(f.string()).css("display",r.visible?"":"none").appendTo(document.body).eq(0).tWindow(r)},getResizeHandlesHtml:function(){var t=new i.stringBuilder;return n.each("n e s w se sw ne nw".split(" "),function(n,i){t.cat('<div class="t-resize-handle t-resize-').cat(i).catIf(" t-icon",i=="se").cat('"></div>')}),t.string()}}),n.fn.tWindow=function(t){return i.create(this,{name:"tWindow",init:function(n,t){return new i.window(n,t)},success:function(t){var r=t.element,u=n(r);u.is(":visible")&&(i.trigger(r,"open"),i.trigger(r,"activated"))},options:t})},n.fn.tWindow.defaults={effects:{list:[{name:"zoom"},{name:"property",properties:["opacity"]}],openDuration:"fast",closeDuration:"fast"},modal:!1,resizable:!0,draggable:!0,minWidth:50,minHeight:50}})(jQuery);