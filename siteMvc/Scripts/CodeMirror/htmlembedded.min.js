CodeMirror.defineMode("htmlembedded",function(n,t){function u(n,t){return n.match(e,!1)?(t.token=f,i.token(n,t.scriptState)):r.token(n,t.htmlState)}function f(n,t){return n.match(o,!1)?(t.token=u,r.token(n,t.htmlState)):i.token(n,t.scriptState)}var e=t.scriptStartRegex||/^<%/i,o=t.scriptEndRegex||/^%>/i,i,r;return{startState:function(){return i=i||CodeMirror.getMode(n,t.scriptingModeSpec),r=r||CodeMirror.getMode(n,"htmlmixed"),{token:t.startOpen?f:u,htmlState:CodeMirror.startState(r),scriptState:CodeMirror.startState(i)}},token:function(n,t){return t.token(n,t)},indent:function(n,t){return n.token==u?r.indent(n.htmlState,t):i.indent?i.indent(n.scriptState,t):void 0},copyState:function(n){return{token:n.token,htmlState:CodeMirror.copyState(r,n.htmlState),scriptState:CodeMirror.copyState(i,n.scriptState)}},electricChars:"/{}:",innerMode:function(n){return n.token==f?{state:n.scriptState,mode:i}:{state:n.htmlState,mode:r}}}},"htmlmixed");CodeMirror.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"});CodeMirror.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"});CodeMirror.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"});CodeMirror.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"});