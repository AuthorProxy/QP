(function(n){if(n.fn.extend({everyTime:function(t,i,r,u,f){return this.each(function(){n.timer.add(this,t,i,r,u,f)})},oneTime:function(t,i,r){return this.each(function(){n.timer.add(this,t,i,r,1)})},stopTime:function(t,i){return this.each(function(){n.timer.remove(this,t,i)})}}),n.extend({timer:{guid:1,global:{},regex:/^([0-9]+)\s*(.*s)?$/,powers:{ms:1,cs:10,ds:100,s:1e3,das:1e4,hs:1e5,ks:1e6},timeParse:function(t){var i,r,u;return t==undefined||t==null?null:(i=this.regex.exec(n.trim(t.toString())),i[2]?(r=parseInt(i[1],10),u=this.powers[i[2]]||1,r*u):t)},add:function(t,i,r,u,f,e){var s=0,o;(n.isFunction(r)&&(f||(f=u),u=r,r=i),i=n.timer.timeParse(i),typeof i!="number"||isNaN(i)||i<=0)||(f&&f.constructor!=Number&&(e=!!f,f=0),f=f||0,e=e||!1,t.$timers||(t.$timers={}),t.$timers[r]||(t.$timers[r]={}),u.$timerID=u.$timerID||this.guid++,o=function(){e&&this.inProgress||(this.inProgress=!0,(++s>f&&f!==0||u.call(t,s)===!1)&&n.timer.remove(t,r,u),this.inProgress=!1)},o.$timerID=u.$timerID,t.$timers[r][u.$timerID]||(t.$timers[r][u.$timerID]=window.setInterval(o,i)),this.global[r]||(this.global[r]=[]),this.global[r].push(t))},remove:function(n,t,i){var r=n.$timers,u,i;if(r){if(t){if(r[t]){if(i)i.$timerID&&(window.clearInterval(r[t][i.$timerID]),delete r[t][i.$timerID]);else for(i in r[t])window.clearInterval(r[t][i]),delete r[t][i];for(u in r[t])break;u||(u=null,delete r[t])}}else for(t in r)this.remove(n,t,i);for(u in r)break;u||(n.$timers=null)}}}}),n.browser.msie)n(window).one("unload",function(){var u=n.timer.global,t,i,r;for(t in u)for(i=u[t],r=i.length;--r;)n.timer.remove(i[r],t)})})(jQuery);